const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingPersonal-C_HerWMM.js","assets/index-DzrxKNnn.js","assets/index-BqtQn6ht.css","assets/UserService-Q1yo_jj5.js","assets/useAxios-iI_x9o6-.js","assets/useValidation-DPCTsogT.js"])))=>i.map(i=>d[i]);
import{d as H,_ as R,B as x,C as Q,E as o,F as a,S as F,I as r,al as V,ad as Y,ae as G,ak as le,M as C,ab as ie,ac as ne,aV as E,O as y,R as g,au as L,a as q,u as U,r as c,w as M,N,a9 as re,af as u,ag as T,bV as se,H as K,ai as W,ah as j,aK as ce,bk as de,bW as ue,bX as ge,bY as me,bZ as fe,b_ as ve,b$ as pe,c0 as be,c1 as _e,c2 as he,aG as Ce,c3 as ye,c4 as we,f as ke,a5 as Se,Y as xe,Z as ze,aa as Ie}from"./index-DzrxKNnn.js";import{F as Ae}from"./FileManagerService-B_drXciZ.js";import{U as Fe}from"./UserService-Q1yo_jj5.js";import{u as Oe}from"./useAppMeta-iLytvd9M.js";import{C as X,I as Pe}from"./ImageCropper-BJyInNCB.js";import{Q as Ve}from"./QBar-NpiT9Tei.js";import"./useAxios-iI_x9o6-.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./use-meta-AT2aoAx3.js";const Qe=H({__name:"ProfileCard",props:{coverImage:{type:String,default:void 0},avatarImage:{type:String,default:void 0},showMedal:{type:Boolean,default:!1},height:{type:String,default:"250px"},avatarTop:{type:String,default:"75px"},avatarSize:{type:String,default:"120px"},descriptionStyle:{type:String,default:""},name:{type:String,default:""},description:{type:String,default:""}},setup(p,{expose:t}){t();const l={};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),Te={class:"text-white absolute-center"};function Be(p,t,l,e,m,f){return x(),Q(F,{flat:"",class:"bg-transparent"},{default:o(()=>[a(F,{flat:""},{default:o(()=>[r("div",{style:V(`height: ${l.height};
            background: url(${l.coverImage?l.coverImage:"/cover.jpg"}), linear-gradient(to right, #000, #000);
            background-position: center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;`)},null,4),r("div",Te,[a(Y,{size:l.avatarSize,style:V({top:l.avatarTop}),class:"shadow-5"},{default:o(()=>[a(G,{"spinner-color":"white",src:l.avatarImage},null,8,["src"])]),_:1},8,["size","style"])])]),_:1}),le(p.$slots,"description",{},()=>[a(C,{class:"text-center",style:V(l.descriptionStyle)},{default:o(()=>[a(ie,{dense:""},{default:o(()=>[a(ne,null,{default:o(()=>[a(E,{class:"text-weight-bold",lines:"1"},{default:o(()=>[y(g(l.name),1)]),_:1}),a(E,{caption:""},{default:o(()=>[y(g(l.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])])]),_:3})}const Le=R(Qe,[["render",Be],["__file","ProfileCard.vue"]]),qe={__name:"ImageCropperCover",props:{dialog:{type:Boolean,default:!1},title:{type:String,default:void 0}},emits:["on-close","on-okay"],setup(p,{expose:t,emit:l}){t();const e=p,m=L(),f=l,{t:i}=q(),{appToast:b}=U(),d=c(null),n=c(null),_=c(null),w=c(1),k=c(1),O=c(!1),P=c(!1),z=c(!1),I=c(null),S=()=>{s(),_.value=null,f("on-close"),P.value=!1},s=()=>{n.value&&(n.value.clear(),n.value.destroy())},h=()=>{s();const v={aspectRatio:16/9,preview:".cropper-img-preview",ready:function(){B()},cropstart:function(){},cropmove:function(){},cropend:function(){B()},crop:function(){},zoom:function(){}};n.value=new X(d.value,v)},J=v=>{v&&(/^image\/\w+/.test(_.value.type)?(d.value.src=URL.createObjectURL(_.value),h()):b("Please choose an image file.",{type:"negative"}))},$=()=>{n.value&&(k.value=k.value*-1,n.value.scaleX(k.value))},ee=()=>{n.value&&(w.value=w.value*-1,n.value.scaleY(w.value))},Z=(v,A)=>new Promise(oe=>{const te=new File([v],A.name,{lastModified:A.lastModified,type:A.type});oe(te)}),ae=()=>{n.value&&n.value.cropped&&(z.value=!0,n.value.getCroppedCanvas().toBlob(async v=>{const A=await Z(v,_.value);z.value=!1,f("on-okay",A),S()},"image/jpeg"))},B=()=>{n.value&&(I.value=n.value.getCroppedCanvas().toDataURL("image/jpeg"))};M(()=>e.dialog,v=>{O.value=v});const D={props:e,authenStore:m,emit:f,t:i,appToast:b,canvasImg:d,cropper:n,originalimagFile:_,horizontalScale:w,verticalScale:k,show:O,maximizedToggle:P,loading:z,priviewImage:I,onClose:S,clearCropper:s,onInitCroper:h,onFileAdded:J,flipHorizontal:$,flipVertical:ee,blobToFile:Z,onOkay:ae,cropData:B,ref:c,watch:M,get Cropper(){return X},get useLang(){return q},get useBase(){return U},ProfileCard:Le,get useAuthenStore(){return L},get biFullscreen(){return ue},get biXSquare(){return ge},get biCrop(){return me},get biZoomIn(){return fe},get biZoomOut(){return ve},get biArrowClockwise(){return pe},get biArrowCounterclockwise(){return be},get biArrowsCollapse(){return _e},get biArrowLeftRight(){return he},get biCheck(){return Ce},get biFileImage(){return ye},get biFullscreenExit(){return we}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}},Ue={class:"row"},je={class:"col-12 col-md-5"},Re={class:"q-pa-md"},Ze={class:"col-12 col-md-7"},De={ref:"canvasImg",style:{display:"block","max-width":"100%",height:"550px"},alt:""};function Ee(p,t,l,e,m,f){return x(),Q(de,{modelValue:e.show,"onUpdate:modelValue":t[6]||(t[6]=i=>e.show=i),persistent:"",maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:o(()=>[a(F,{style:{"min-width":"80%"},flat:"",bordered:""},{default:o(()=>[a(Ve,null,{default:o(()=>[a(N,{name:e.biCrop},null,8,["name"]),r("div",null,g(l.title||""),1),a(re),a(u,{dense:"",flat:"",icon:e.maximizedToggle?e.biFullscreenExit:e.biFullscreen,onClick:t[0]||(t[0]=i=>e.maximizedToggle=!e.maximizedToggle)},{default:o(()=>[a(T,null,{default:o(()=>[y(g(e.maximizedToggle?e.t("minimize"):e.t("maximize")),1)]),_:1})]),_:1},8,["icon"]),a(u,{dense:"",flat:"",icon:e.biXSquare,onClick:e.onClose},{default:o(()=>[a(T,null,{default:o(()=>[y(g(e.t("base.close")),1)]),_:1})]),_:1},8,["icon"])]),_:1}),r("div",Ue,[r("div",je,[a(C,null,{default:o(()=>[a(se,{filled:"","bottom-slots":"",modelValue:e.originalimagFile,"onUpdate:modelValue":[t[1]||(t[1]=i=>e.originalimagFile=i),e.onFileAdded],label:e.t("base.chooseFile"),counter:"","max-files":"1",accept:".jpg, .png, image/*"},{prepend:o(()=>[a(N,{name:e.biFileImage},null,8,["name"])]),hint:o(()=>[y(g(e.t("error.filesValidationSizeAndType",{size:10,extension:".jpg, .png"})),1)]),_:1},8,["modelValue","label"])]),_:1}),e.originalimagFile?(x(),K(W,{key:0},[a(C,{class:"q-gutter-sm text-center"},{default:o(()=>{var i,b;return[a(e.ProfileCard,{"avatar-image":(b=(i=e.authenStore.auth)==null?void 0:i.avatar)==null?void 0:b.image,"cover-image":e.priviewImage,name:e.authenStore.loginedDisplay,description:e.t("app.name"),height:"250px","avatar-top":"105px",descriptionStyle:"margin-top:35px"},null,8,["avatar-image","cover-image","name","description"])]}),_:1}),r("div",Re,[a(u,{icon:e.biCheck,label:e.t("base.okay"),class:"full-width",color:"positive",unelevated:"",loading:e.loading,onClick:e.onOkay},null,8,["icon","label","loading"])])],64)):j("",!0)]),r("div",Ze,[a(C,null,{default:o(()=>[r("div",{class:ce(p.$q.dark.isActive?"bg-grey-10":"bg-grey-1")},[r("img",De,null,512)],2)]),_:1}),e.originalimagFile?(x(),Q(C,{key:0,class:"q-gutter-sm"},{default:o(()=>[a(u,{icon:e.biZoomIn,dense:"",label:e.t("zoomIn"),flat:"",onClick:t[2]||(t[2]=i=>e.cropper.zoom(.1))},null,8,["icon","label"]),a(u,{icon:e.biZoomOut,dense:"",label:e.t("zoomOut"),flat:"",onClick:t[3]||(t[3]=i=>e.cropper.zoom(-.1))},null,8,["icon","label"]),a(u,{label:e.t("rotateLeft"),dense:"",icon:e.biArrowCounterclockwise,flat:"",onClick:t[4]||(t[4]=i=>e.cropper.rotate(-45))},null,8,["label","icon"]),a(u,{label:e.t("rotateRight"),dense:"",icon:e.biArrowClockwise,flat:"",onClick:t[5]||(t[5]=i=>e.cropper.rotate(45))},null,8,["label","icon"]),a(u,{label:e.t("flipHorizontal"),dense:"",icon:e.biArrowLeftRight,flat:"",onClick:e.flipHorizontal},null,8,["label","icon"]),a(u,{label:e.t("flipVorizontal"),dense:"",icon:e.biArrowsCollapse,flat:"",onClick:e.flipVertical},null,8,["label","icon"])]),_:1})):j("",!0)])])]),_:1})]),_:1},8,["modelValue","maximized"])}const Me=R(qe,[["render",Ee],["__file","ImageCropperCover.vue"]]),Ne=H({__name:"profile",setup(p,{expose:t}){t();const l=xe(()=>ze(()=>import("./SettingPersonal-C_HerWMM.js"),__vite__mapDeps([0,1,2,3,4,5])));Oe();const{t:e}=q(),{appLoading:m}=U(),{uploadApi:f}=Ae(),{updateUserAvatar:i,updateUserCover:b}=Fe(),d=L(),n=c(!1),_=c(!1),w=async S=>{m();const s=await f(S);if(s&&d.auth&&s.id){await i(s.id);const h=d.auth;h.avatar&&(h.avatar.thumbnail=s.fileThumbnailPath,h.avatar.image=s.filePath)}m(!1)},k=()=>{n.value=!0},O=()=>{_.value=!0},P=async S=>{m();const s=await f(S);if(s&&d.auth&&s.id){await b(s.id);const h=d.auth;h.cover={thumbnail:s.fileThumbnailPath,image:s.filePath}}m(!1)},z=ke(()=>`height: 175px;
            background: url(${d.loginedCover?d.loginedCover:"/cover.jpg"}), linear-gradient(to right, #000, #000);
            background-position: center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;`),I={SettingPersonal:l,t:e,appLoading:m,uploadApi:f,updateUserAvatar:i,updateUserCover:b,authenStore:d,dialog:n,dialogCover:_,onOkay:w,onOpenCropper:k,onOpenCropperCover:O,onUploadCover:P,coverStle:z,get biPencilFill(){return Se},ImageCropper:Pe,ImageCropperCover:Me};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),Xe={class:"q-pl-lg"},He={class:"text-h6"},Ye={class:"text-white absolute-right q-pa-md"},Ge={class:"text-white absolute-center"},Ke={class:"absolute-bottom",style:{top:"55px"}},We={class:"text-h6 text-weight-bold q-mt-md"},Je={class:"text-muted"};function $e(p,t,l,e,m,f){return x(),K(W,null,[r("div",Xe,[a(F,{square:"",flat:"",class:"bg-transparent"},{default:o(()=>[a(C,null,{default:o(()=>[r("div",He,g(e.t("base.editPhoto")),1),a(Ie)]),_:1}),a(C,null,{default:o(()=>[e.authenStore.auth?(x(),Q(F,{key:0,class:"shadow-up-5"},{default:o(()=>[r("div",{style:V(e.coverStle)},null,4),r("div",Ye,[a(u,{onClick:e.onOpenCropperCover,round:"",unelevated:"",color:"pink",icon:e.biPencilFill},{default:o(()=>[a(T,null,{default:o(()=>[y(g(e.t("base.changeCover")),1)]),_:1})]),_:1},8,["icon"])]),r("div",Ge,[a(Y,{size:"120px",style:{top:"75px"},class:"shadow-5"},{default:o(()=>[a(G,{"spinner-color":"white",src:e.authenStore.loginedAvatar},null,8,["src"]),r("div",Ke,[a(u,{onClick:e.onOpenCropper,round:"",icon:e.biPencilFill,color:"pink"},{default:o(()=>[a(T,null,{default:o(()=>[y(g(e.t("base.changeAvatar")),1)]),_:1})]),_:1},8,["icon"])])]),_:1})])]),_:1})):j("",!0)]),_:1}),a(C,{class:"text-center"},{default:o(()=>[r("div",We,g(e.authenStore.loginedDisplay),1),r("div",Je,g(e.t("app.name")),1)]),_:1})]),_:1}),a(e.SettingPersonal)]),a(e.ImageCropper,{title:e.t("cropAvatar"),dialog:e.dialog,onOnClose:t[0]||(t[0]=i=>e.dialog=!1),onOnOkay:e.onOkay},null,8,["title","dialog"]),a(e.ImageCropperCover,{title:e.t("base.changeCover"),dialog:e.dialogCover,onOnClose:t[1]||(t[1]=i=>e.dialogCover=!1),onOnOkay:e.onUploadCover},null,8,["title","dialog"])],64)}const ca=R(Ne,[["render",$e],["__file","profile.vue"]]);export{ca as default};
