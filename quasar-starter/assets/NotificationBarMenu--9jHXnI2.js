const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SkeletonItem-dkfTcFh0.js","assets/SkeletonItem.vue_vue_type_script_setup_true_lang-BWbMMSax.js","assets/index-D_pQv8pS.js","assets/index-ZrKcW1Mk.css","assets/BaseResult-BJvdw1jW.js","assets/BaseResult.vue_vue_type_script_setup_true_lang-PpqeFt5W.js"])))=>i.map(i=>d[i]);
import{c4 as B,bY as k,r as p,er as S,o as g,l as E,u as P,m as d,n as y,w as l,T as I,x as N,J as o,c2 as L,L as h,M as _,Q as x,bR as M,ax as b,aE as T,t as O,aF as w,b7 as Q,ae as C,es as D,aN as R}from"./index-D_pQv8pS.js";import{C as V}from"./ClosePopup-DKr1Zozv.js";import{u as F}from"./useAxios-QRQbEkIG.js";const A=()=>(F(),{updateFcmSetting:async s=>{},refreshFcmToken:async s=>{},findAllByUser:async(s,n)=>new Promise(t=>{setTimeout(()=>{t([])},1500)}),findCountAllNotRead:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotify:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotifyAll:async()=>new Promise(s=>{setTimeout(()=>{s(null)},500)})}),U=B("notificationStore",()=>{const{cacheNotifyCount:f}=k(),a=p({lastestId:0,totalNotify:0});return{notify:a,setNotify:e=>{a.value.totalNotify=e.totalNotify,a.value.lastestId=e.lastestId},setLastNotify:e=>{f.value.lastestId=e}}}),$=()=>{const{findCountAllNotRead:f}=A(),{cacheNotifyCount:a}=k(),r=U(),{notify:i}=S(r),{setNotify:e}=r;return g(()=>{i.value.totalNotify=999}),{notify:i,setNotify:e,resetBadgeCount:()=>{i.value.totalNotify=0},notificationLink:(t,c)=>{if(t&&c){if(t=="LIKE_POST"||t=="SHARE"||t=="COMMENT_POST")return`/post/view/${c}`;if(t=="LIKE_COMMENT")return`/comment/view/${c}`;if(t=="COMMENT_REPLY")return`/comment/view/${c}?isReply=1`}},fetchNotReadNotify:async()=>{const t=await f(a.value&&a.value.lastestId?a.value.lastestId:0);t&&t.lastestId&&t.totalNotify&&e(t)}}},K={class:"text-h6"},J=E({__name:"NotificationBarMenu",setup(f){const a=w(()=>R(()=>import("./SkeletonItem-dkfTcFh0.js"),__vite__mapDeps([0,1,2,3]))),r=w(()=>R(()=>import("./BaseResult-BJvdw1jW.js"),__vite__mapDeps([4,5,2,3]))),{findAllByUser:i}=A(),{t:e}=P(),u=p(!1),s=p([]),{notify:n,resetBadgeCount:t}=$();g(async()=>{u.value=!0,await c(),u.value=!1});const c=async()=>{const m=await i(1,10);return m&&m.length>0&&s.value.push(...m),new Promise(v=>{v(!0)})};return(m,v)=>(y(),d(C,{round:"",dense:"",flat:"",onClick:o(t),icon:o(D)},{default:l(()=>[o(n)&&o(n).totalNotify?(y(),d(L,{key:0,color:"negative",rounded:"","text-color":"white",floating:""},{default:l(()=>[h(_(o(n).totalNotify>99?"99+":o(n).totalNotify),1)]),_:1})):I("",!0),N(x,null,{default:l(()=>[h(_(o(e)("nav.notifications")),1)]),_:1}),N(M,{anchor:"bottom left",self:"top left",style:{width:"360px"}},{default:l(()=>[N(b,{flat:""},{default:l(()=>[N(T,null,{default:l(()=>[O("div",K,_(o(e)("base.notification")),1)]),_:1}),u.value?(y(),d(o(a),{key:0,items:5,show:""})):s.value.length>0?(y(),d(T,{key:1},{default:l(()=>[Q(N(C,{unelevated:"",rounded:"",color:"primary",class:"full-width",label:o(e)("base.readAllNotifications"),to:"/notifications"},null,8,["label"]),[[V]])]),_:1})):(y(),d(o(r),{key:2,status:"empty",description:o(e)("error.dataNotfound")},null,8,["description"]))]),_:1})]),_:1})]),_:1},8,["onClick","icon"]))}});export{J as default};
