const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SkeletonItem-B5K1SKDi.js","assets/SkeletonItem.vue_vue_type_script_setup_true_lang-G2xTrWP4.js","assets/index-D2_s7zbP.js","assets/index-BgtrcqL_.css","assets/BaseResult-CuumZR92.js","assets/BaseResult.vue_vue_type_script_setup_true_lang-fjuZMLDc.js"])))=>i.map(i=>d[i]);
import{c9 as B,c1 as k,r as p,eu as S,o as g,l as P,u as E,m as d,n as y,w as l,T as I,x as m,J as o,c7 as L,L as h,M as _,bX as M,ay as x,aF as w,t as O,aG as T,b8 as b,af as C,ev as D,aO as R}from"./index-D2_s7zbP.js";import{C as V}from"./ClosePopup-2-dEFwXe.js";import{u as F}from"./useAxios-DC4_ZzHn.js";import{_ as Q}from"./BaseTooltip.vue_vue_type_script_setup_true_lang-NBn_gdh-.js";const A=()=>(F(),{updateFcmSetting:async s=>{},refreshFcmToken:async s=>{},findAllByUser:async(s,n)=>new Promise(t=>{setTimeout(()=>{t([])},1500)}),findCountAllNotRead:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotify:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotifyAll:async()=>new Promise(s=>{setTimeout(()=>{s(null)},500)})}),U=B("notificationStore",()=>{const{cacheNotifyCount:f}=k(),a=p({lastestId:0,totalNotify:0});return{notify:a,setNotify:e=>{a.value.totalNotify=e.totalNotify,a.value.lastestId=e.lastestId},setLastNotify:e=>{f.value.lastestId=e}}}),$=()=>{const{findCountAllNotRead:f}=A(),{cacheNotifyCount:a}=k(),r=U(),{notify:i}=S(r),{setNotify:e}=r;return g(()=>{i.value.totalNotify=999}),{notify:i,setNotify:e,resetBadgeCount:()=>{i.value.totalNotify=0},notificationLink:(t,c)=>{if(t&&c){if(t=="LIKE_POST"||t=="SHARE"||t=="COMMENT_POST")return`/post/view/${c}`;if(t=="LIKE_COMMENT")return`/comment/view/${c}`;if(t=="COMMENT_REPLY")return`/comment/view/${c}?isReply=1`}},fetchNotReadNotify:async()=>{const t=await f(a.value&&a.value.lastestId?a.value.lastestId:0);t&&t.lastestId&&t.totalNotify&&e(t)}}},K={class:"text-h6"},X=P({__name:"NotificationBarMenu",setup(f){const a=T(()=>R(()=>import("./SkeletonItem-B5K1SKDi.js"),__vite__mapDeps([0,1,2,3]))),r=T(()=>R(()=>import("./BaseResult-CuumZR92.js"),__vite__mapDeps([4,5,2,3]))),{findAllByUser:i}=A(),{t:e}=E(),u=p(!1),s=p([]),{notify:n,resetBadgeCount:t}=$();g(async()=>{u.value=!0,await c(),u.value=!1});const c=async()=>{const N=await i(1,10);return N&&N.length>0&&s.value.push(...N),new Promise(v=>{v(!0)})};return(N,v)=>(y(),d(C,{round:"",dense:"",flat:"",onClick:o(t),icon:o(D)},{default:l(()=>[o(n)&&o(n).totalNotify?(y(),d(L,{key:0,color:"negative",rounded:"","text-color":"white",floating:""},{default:l(()=>[h(_(o(n).totalNotify>99?"99+":o(n).totalNotify),1)]),_:1})):I("",!0),m(Q,null,{default:l(()=>[h(_(o(e)("nav.notifications")),1)]),_:1}),m(M,{anchor:"bottom left",self:"top left",style:{width:"360px"}},{default:l(()=>[m(x,{flat:""},{default:l(()=>[m(w,null,{default:l(()=>[O("div",K,_(o(e)("base.notification")),1)]),_:1}),u.value?(y(),d(o(a),{key:0,items:5,show:""})):s.value.length>0?(y(),d(w,{key:1},{default:l(()=>[b(m(C,{unelevated:"",rounded:"",color:"primary",class:"full-width",label:o(e)("base.readAllNotifications"),to:"/notifications"},null,8,["label"]),[[V]])]),_:1})):(y(),d(o(r),{key:2,status:"empty",description:o(e)("error.dataNotfound")},null,8,["description"]))]),_:1})]),_:1})]),_:1},8,["onClick","icon"]))}});export{X as default};
