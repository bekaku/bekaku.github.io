const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BaseLoadmore-CgH_w-kf.js","assets/index-DApiqAPi.js","assets/index-Df8ypqlk.css"])))=>i.map(i=>d[i]);
import{d as E,u as F,j as H,k as l,a$ as K,b0 as R,s as q,c as m,o as u,w as s,e as a,K as o,F as C,a6 as S,aO as W,a as w,O as r,b1 as j,aP as J,Y as b,N as P,b2 as X,W as G,X as x,a1 as Q,b3 as Z,b4 as ee,b5 as ae,R as se,b6 as te,J as oe,M as le,ad as ne,b7 as ie,am as re}from"./index-DApiqAPi.js";import{u as ue,A as de}from"./useAuth-DlW7VuJR.js";import{U as ce}from"./UserService-C-gRDK6S.js";import{u as pe}from"./useAppMeta-D1tG-2Fx.js";import{u as me}from"./usePaging-TbcWih_Q.js";import{B as fe}from"./BaseCard-NmWS53hk.js";import{_ as ve}from"./SettingLayout.vue_vue_type_script_setup_true_lang-Dv2K_UA0.js";import{_ as ge}from"./PasswordForm.vue_vue_type_script_setup_true_lang-Cx55E0KH.js";import"./useAxios-xrYQU4R3.js";import"./use-meta-CQ5ipUCD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseMenuItems.vue_vue_type_style_index_0_lang-CkO5Fxnw.js";import"./BaseAvatar-ByLNwPJu.js";import"./BaseImage-BbeNOHyI.js";import"./FileManagerService-BePLkOcz.js";import"./_commonjsHelpers-BosuxZz1.js";import"./BasePage.vue_vue_type_script_setup_true_lang-Df4ebVCv.js";import"./useValidation-B-hJKTQl.js";import"./BaseButton-DF6vGR5w.js";const _e={class:"text-h6"},we={class:"text-weight-medium"},be={class:"text-grey-8"},Pe={key:0},he={class:"text-grey-8 q-gutter-xs"},Fe=E({__name:"security",setup(ye){const L=ne(()=>re(()=>import("./BaseLoadmore-CgH_w-kf.js"),__vite__mapDeps([0,1,2])));pe();const{appConfirm:N,appLoading:D}=F(),{t:n}=H(),{signOut:O}=ue(),{selfUpdatePassword:M,currentAuthSession:U}=ce(),{removeAccessTokenSession:I}=de(),{pages:d}=me(10),h=l(""),y=l("");l(""),l(!1);const A=l(!0),c=l(!1),f=l([]),k=l(!0),v=l(null),p=l(!1),g=l(!1);K(()=>{B()}),R(()=>{v.value&&(clearTimeout(v.value),v.value=null)});const T=q(()=>`?page=${d.value.current>0?d.value.current-1:0}&size=${d.value.itemsPerPage}`),V=async()=>{c.value=!0;const t=await M({userChangePasswordRequest:{password:h.value,newPassword:y.value,logoutAllDevice:A.value}});c.value=!1,t&&t.status=="OK"&&(v.value=setTimeout(()=>{O()},1500))},$=async()=>{d.value.current++,await B()},B=async()=>{const t=await U(T.value);t&&t.length>0?(f.value.push(...t),t.length<d.value.itemsPerPage&&(p.value=!0)):p.value=!0,g.value||(g.value=!0),k.value=!1},z=t=>t?ie.formatDate(t,"MMMM DD YYYY, HH:mm:ss"):"-",Y=async t=>{if(await N(n("authSessions"),n("base.deleteConfirm"))){const e=f.value[t];if(e&&e.id){D();const _=await I(e.id);D(!1),_&&_.status=="OK"&&f.value.splice(t,1)}}};return(t,i)=>(u(),m(ve,null,{content:s(()=>[a(fe,{title:o(n)("updatePassword")},{default:s(()=>[a(S,null,{default:s(()=>[a(ge,{currentPassword:h.value,"onUpdate:currentPassword":i[0]||(i[0]=e=>h.value=e),newPassword:y.value,"onUpdate:newPassword":i[1]||(i[1]=e=>y.value=e),logoutAllDevice:A.value,"onUpdate:logoutAllDevice":i[2]||(i[2]=e=>A.value=e),loading:c.value,"onUpdate:loading":i[3]||(i[3]=e=>c.value=e),"show-current-password":"","show-logout":"",onOnSubmit:V,"submit-label":o(n)("updatePassword"),"action-align":"left"},null,8,["currentPassword","newPassword","logoutAllDevice","loading","submit-label"])]),_:1}),a(W),a(S,null,{default:s(()=>[w("div",_e,r(o(n)("authSessions")),1)]),_:1}),k.value?(u(),m(S,{key:0,class:"text-center"},{default:s(()=>[a(j,{color:"primary",size:"3em"})]),_:1})):(u(),m(J,{key:1,separator:"",class:"rounded-borders"},{default:s(()=>[a(b,{header:""},{default:s(()=>[P(r(o(n)("authSessionsHelp")),1)]),_:1}),a(X,{style:{"max-height":"350px"},items:f.value},{default:s(({item:e,index:_})=>[(u(),m(G,{key:e.id},{default:s(()=>[a(x,{avatar:"",top:""},{default:s(()=>[a(Q,{name:e.loginFrom=="WEB"?o(Z):e.loginFrom=="IOS"?o(ee):o(ae),color:"black",size:"34px"},null,8,["name"])]),_:2},1024),a(x,{top:""},{default:s(()=>[a(b,{lines:"1"},{default:s(()=>[w("span",we,"["+r(e.ipAddredd)+"]",1),w("span",be," - "+r(e.hostName),1),e.activeNow?(u(),se("span",Pe,[a(Q,{size:"lg",name:o(te),color:"positive"},null,8,["name"])])):C("",!0)]),_:2},1024),a(b,{lines:"1"},{default:s(()=>[P(r(e.agent),1)]),_:2},1024),a(b,{lines:"1",caption:""},{default:s(()=>[P(r(o(n)("lastestActive")+" "+z(e.lastestActive||e.createdDate)),1)]),_:2},1024)]),_:2},1024),a(x,{top:"",side:""},{default:s(()=>[w("div",he,[a(oe,{class:"gt-xs",size:"12px",flat:"",round:"",icon:"bi-trash",onClick:Ae=>Y(_)},{default:s(()=>[a(le,null,{default:s(()=>[P(r(o(n)("base.delete")),1)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))]),_:1},8,["items"])]),_:1})),!p.value&&g.value?(u(),m(o(L),{key:2,loading:c.value,"frist-loaded":g.value,"is-infinite-disabled":p.value,label:o(n)("base.loadMore"),onOnNextPage:$,button:"","show-icon":"","full-width":""},null,8,["loading","frist-loaded","is-infinite-disabled","label"])):C("",!0)]),_:1},8,["title"])]),_:1}))}});export{Fe as default};
