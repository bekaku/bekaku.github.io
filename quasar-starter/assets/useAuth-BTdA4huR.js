import{bg as x,bh as b,u as D,j as K,A as w,bi as a,bj as u,bk as p,bl as y,bm as d,P as q}from"./index-UTJsbmGU.js";import{u as R,a as V}from"./useAxios-D87ZUWP6.js";const B=()=>(R(),{singin:async n=>(console.log("AuthenService.ts > singin",n),new Promise(t=>{setTimeout(()=>{t(x)},500)})),singoutToServer:async n=>(console.log("AuthenService.ts > singoutToServer",n),new Promise(t=>{setTimeout(()=>{t({status:"OK",timestamp:"2025-03-14 13:30"})},500)})),refreshToken:async n=>new Promise(t=>{setTimeout(()=>{t(null)},500)}),removeAccessTokenSession:async n=>new Promise(t=>{setTimeout(()=>{t({status:"OK",timestamp:"2025-03-14 13:30"})},500)}),requestVerifyCodeToResetPwd:async n=>new Promise(t=>{setTimeout(()=>{t(null)},500)}),sendVerifyCodeToResetPwd:async n=>new Promise(t=>{setTimeout(()=>{t(null)},500)}),resetPassword:async n=>new Promise(t=>{setTimeout(()=>{t(null)},500)})}),j=()=>{const s=q,i=b(),{appConfirm:h,appLoading:c,isDevMode:l}=D(),{t:m}=K(),{singoutToServer:A}=B(),{logoutClear:n}=V(),t=()=>{},g=e=>s&&s.get(e)||null,S=e=>{e!=null&&i.setAuthen(e)},P=async()=>{if(!s)return;if(await h(m("app.monogram"),m("helper.logoutConfirm"))){c();const r=g(p),o=i.auth?.email;await T(r,o),c(!1),f()}},k=e=>{v(s,e,!l())},v=(e,r,o=!1)=>{e&&(e.set(w,r.authenticationToken,{expires:a(u),path:"/",secure:o,sameSite:"Lax"}),e.set(p,r.refreshToken,{expires:a(u),path:"/",secure:o,sameSite:"Strict"}),e.set(y,r.expiresAt,{expires:a(u),path:"/",secure:o,sameSite:"Strict"}),e.set(d,Date.now().toString(),{expires:a(u),path:"/",secure:o,sameSite:"Strict"}))},T=async(e,r)=>!e||!r?new Promise(o=>{o(!0)}):(await A({refreshToken:{refreshToken:e,email:r}}),new Promise(o=>{o(!0)})),C=()=>new Promise(e=>{s&&(s.remove(w,{path:"/"}),s.remove(p,{path:"/"}),s.remove(y,{path:"/"}),s.remove(d,{path:"/"})),n(),e(!0)}),f=async(e=!0)=>{await C(),i.logout(),e&&(window.location.replace("/auth/login"),window.location.replace("/"))};return{initAppAuthen:t,signOut:P,setAuthen:S,destroyAuthDataAndRedirect:f,setAuthenticationCookies:k,logoutToServer:T}};export{B as A,j as u};
