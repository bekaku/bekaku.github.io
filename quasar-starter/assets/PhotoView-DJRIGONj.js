import{d as U,bB as W,k as c,bh as X,j as q,u as J,a$ as Y,s as z,aW as G,c as g,o as f,w as i,e,$ as _,a as ee,d4 as ae,F as k,R as $,K as s,d5 as te,N as p,O as w,J as m,ci as le,d6 as oe,S as se,cp as ne,d7 as ie,bZ as ue,d8 as re,bo as de,aP as fe,bd as V,W as L,X as b,a1 as N,d9 as ce,da as me,aA as he,cv as ve,bY as ge}from"./index-UTJsbmGU.js";import{C as S}from"./ClosePopup-CwsVPSEh.js";import{F as we,j as be,k as ye}from"./FileManagerService-oa2a8H9O.js";import{B as ke}from"./BaseAvatar-DYsAAppw.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useAxios-D87ZUWP6.js";import"./_commonjsHelpers-BosuxZz1.js";import"./BaseImage-C5pcvk_j.js";const Ce={key:2,class:"q-ml-xs text-caption"},xe={class:"row items-center"},Be=U({__name:"PhotoView",props:{showDialog:{type:Boolean,default:!1},showDeleteImage:{type:Boolean,default:!1},maximized:{type:Boolean,default:!0},fetch:{type:Boolean,default:!1},showArrow:{type:Boolean,default:!0},user:{type:Object,default:()=>null},files:{type:Array,default:()=>[]},images:{type:Array,default:()=>[]},selectedIndex:{type:Number,default:0}},emits:["on-close","update:showDialog","on-before-hide","on:delete"],setup(l,{emit:R}){const u=l,{screen:T}=W(),{fethCdnData:F}=we(),h=c(),C=X(),y=R,{t:v}=q(),{appConfirm:O}=J(),a=c(0),d=c([]),x=c(!1),B=c(!1),D=c(!0);Y(async()=>{a.value=u.selectedIndex,await j(),D.value=!1,document.addEventListener("keydown",Z)});const P=z({get:()=>u.showDialog,set:t=>y("update:showDialog",t)}),Z=t=>{t.key==="ArrowLeft"?(x.value=!0,B.value=!1,a.value>0&&a.value--):t.key==="ArrowRight"&&(x.value=!1,B.value=!0,a.value<I.value-1&&a.value++)},A=()=>{P.value=!1,y("on-close")},I=z(()=>u.files&&u.files.length?u.files.length:u.images&&u.images.length?u.images.length:0),j=async()=>{const t=u.files,o=u.images;if(t&&t.length>0)for(const n of t)if(u.fetch){const r=await Q(n.filePath);r&&d.value.push(r)}else d.value.push(n.filePath);else if(o&&o.length>0)for(const n of o)if(u.fetch){const r=await Q(n.image);r&&d.value.push(r)}else d.value.push(n.image);return new Promise(n=>{n(!0)})},Q=async t=>{const o=await F(t);return o?new Promise(n=>{n(o)}):new Promise(n=>{n(null)})},M=async()=>{if(d.value.length>0){const t=d.value[a.value];t&&be(t,ye())}},E=async()=>{await O(v("app.monogram"),v("base.deletePhotoConfirm"))&&y("on:delete",a.value)},H=()=>{h.value&&h.value.zoomIn()},K=()=>{h.value&&h.value.zoomOut()};return(t,o)=>{const n=G("v-zoomer-gallery");return f(),g(ge,{"model-value":P.value,onHide:A,onBeforeHide:o[3]||(o[3]=r=>t.$emit("on-before-hide")),maximized:l.maximized,"full-width":"","full-height":""},{default:i(()=>[e(_,{class:"text-white",dark:""},{default:i(()=>[e(ae,null,{default:i(()=>[l.user&&l.user.avatar?.thumbnail?(f(),g(ke,{key:0,src:l.user.avatar.thumbnail,size:"32px"},null,8,["src"])):k("",!0),s(T).gt.xs?(f(),g(te,{key:1},{default:i(()=>[p(w(`${s(v)("base.photo")} ${a.value+1}/${l.files.length>0?l.files.length:l.images.length>0?l.images.length:0}`),1)]),_:1})):(f(),$("span",Ce,w(`${a.value+1}/${l.files.length>0?l.files.length:l.images.length>0?l.images.length:0}`),1)),e(m,{dense:"",flat:"",round:"",icon:s(le),onClick:H},null,8,["icon"]),e(m,{dense:"",flat:"",round:"",icon:s(oe),onClick:K},null,8,["icon"]),l.showArrow?(f(),$(se,{key:3},[e(m,{dense:"",flat:"",round:"",icon:s(ne),disable:a.value==0,onClick:o[0]||(o[0]=r=>a.value=a.value-1)},null,8,["icon","disable"]),e(m,{dense:"",flat:"",round:"",icon:s(ie),disable:a.value==I.value-1,onClick:o[1]||(o[1]=r=>a.value=a.value+1)},null,8,["icon","disable"])],64)):k("",!0),e(ue),e(m,{flat:"",round:"",icon:s(re)},{default:i(()=>[e(de,null,{default:i(()=>[e(fe,{style:{"min-width":"100px"}},{default:i(()=>[V((f(),g(L,{clickable:"",onClick:M},{default:i(()=>[e(b,{avatar:""},{default:i(()=>[e(N,{name:s(ce)},null,8,["name"])]),_:1}),e(b,null,{default:i(()=>[p(w(s(v)("base.download")),1)]),_:1})]),_:1})),[[S]]),l.showDeleteImage&&s(C)&&s(C).auth?V((f(),g(L,{key:0,clickable:"",onClick:E},{default:i(()=>[e(b,{avatar:""},{default:i(()=>[e(N,{name:s(me)},null,8,["name"])]),_:1}),e(b,null,{default:i(()=>[p(w(s(v)("base.delete")),1)]),_:1})]),_:1})),[[S]]):k("",!0)]),_:1})]),_:1})]),_:1},8,["icon"]),e(m,{flat:"",round:"",icon:s(he),onClick:A},null,8,["icon"])]),_:1}),ee("div",xe,[e(n,{style:{width:"100%",height:"90vh","background-color":"black",cursor:"pointer"},ref_key:"vZoomerRef",ref:h,list:d.value,modelValue:a.value,"onUpdate:modelValue":o[2]||(o[2]=r=>a.value=r)},null,8,["list","modelValue"]),e(ve,{showing:D.value,"label-class":"text-white"},null,8,["showing"])])]),_:1})]),_:1},8,["model-value","maximized"])}}}),Le=pe(Be,[["__scopeId","data-v-614d0ab4"]]);export{Le as default};
