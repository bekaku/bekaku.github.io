import{l as G,u as Q,r as d,dc as z,y as W,bx as X,o as q,c as b,a5 as J,m as r,n as o,w as s,x as i,bz as Y,T as j,bB as K,L as Z,M as ee,J as l,a1 as te,d1 as ae,aF as se,aA as h,bk as oe,bg as g,R as k,W as C,X as _,dd as I,bR as ie}from"./index-D2_s7zbP.js";import{C as L}from"./ChatHistoryItem-BLy5ps83.js";import{u as le}from"./chatStore-B4BY8DG5.js";import{B as ne}from"./BaseButton-CvbVWVz2.js";import{B as re}from"./BaseCard-DIxBFYod.js";import{B as ce}from"./BaseDropdownMenu-DhVTDjgl.js";import{_ as ue}from"./BaseInput.vue_vue_type_script_setup_true_lang-DUX5V_hQ.js";import{_ as E}from"./BaseResult.vue_vue_type_script_setup_true_lang-fjuZMLDc.js";import{_ as N}from"./BaseScrollArea.vue_vue_type_script_setup_true_lang-Ce9av46d.js";import{B as me}from"./BaseTabs-dn-TcfWk.js";import"./ClosePopup-2-dEFwXe.js";import"./BaseContentHtml.vue_vue_type_script_setup_true_lang-CVw-4U3f.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseAvatar-Dd0BukBT.js";import"./FileManagerService-CwRtvFJO.js";import"./useAxios-DC4_ZzHn.js";import"./BaseLabelValueItem.vue_vue_type_script_setup_true_lang-C_X5PB88.js";import"./BaseTooltip.vue_vue_type_script_setup_true_lang-NBn_gdh-.js";const Ae=G({__name:"ChatLeft",props:{groupItem:{},height:{},showClose:{type:Boolean,default:!1},autoDetect:{type:Boolean,default:!0}},emits:["on-item-click","on-close"],setup(T,{emit:O}){const{t:n}=Q(),m=le(),x=O,S=d("ALL"),R=d([{label:n("chats.all"),value:"ALL"},{label:n("chats.groups"),value:"GROUP"},{label:n("chats.favorite"),value:"FAVORITE"}]),c=d([...z.dataList]),v=d();d(!1),d("PERSONAL");const V=d([{label:n("chats.addNewprivateChat"),icon:W,value:"PERSONAL"},{label:n("chats.groupChatCreate"),icon:X,value:"GROUP"}]);q(async()=>{T.autoDetect&&P()});const p=b(()=>{const e=v.value?.toString().trim();return e?c.value.filter(t=>t.groupName&&t.groupName.toLowerCase().includes(e.toLowerCase())):c.value}),M=b(()=>p.value.filter(e=>e.chatType=="GROUP")),B=b(()=>p.value.filter(e=>e.favorite)),P=()=>{if(c.value&&c.value.length>0){const e=c.value[0];e&&f(e)}},U=e=>{console.log("onMenuClick",e)},f=e=>{x("on-item-click",e)},$=e=>{console.log("onUpdatesearch",e)},w=e=>c.value.findIndex(t=>t.id==e),y=e=>c.value[e],D=async()=>{const e=await ie(c.value,"pin","desc");c.value=e},H=e=>{e!=null&&e>=0&&y(e)&&c.value.splice(e,1)},A=async(e,t=!0)=>{if(e){const a=w(e);if(a>=0){const u=y(a);u&&u.id&&(u.totalNewMessage=0)}}},F=()=>{if(!m?.chatId||!m?.chatSettingType){m.clearSetting();return}const e=w(m.chatId);if(e>=0){const t=y(e);if(t)switch(m.chatSettingType){case"NOTIFICATION":t.muteNotify=!t.muteNotify;break;case"PIN":t.pin=!t.pin,D();break;case"FAVORITE":t.favorite=!t.favorite;break;case"LEAVE":H(e);break;case"CLEAR_NEW_MESSAGE_NUMBER":t.totalNewMessage>0&&t.id&&A(t.id,!0);break;case"CLEAR_NEW_MESSAGE_NUMBER_ONLY":t.id&&A(t.id,!1);break}}m.clearSetting()};return J(m,e=>{e.toggleChatSetting&&F()}),(e,t)=>(o(),r(re,{flat:"",bordered:!1},{default:s(()=>[i(Y,null,{default:s(()=>[i(K,{class:"text-weight-bold"},{default:s(()=>[Z(ee(l(n)("chats.chats")),1)]),_:1}),e.showClose?(o(),r(ne,{key:0,flat:"",round:"",icon:l(te),onClick:t[0]||(t[0]=a=>e.$emit("on-close"))},null,8,["icon"])):j("",!0),i(ce,{items:V.value,tooltip:l(n)("chats.addNewChat"),icon:l(ae),onOnClick:U},null,8,["items","tooltip","icon"])]),_:1}),i(se,null,{default:s(()=>[i(ue,{modelValue:v.value,"onUpdate:modelValue":[t[1]||(t[1]=a=>v.value=a),$],label:l(n)("base.search"),debounce:250},{prepend:s(()=>[i(h,{name:l(oe)},null,8,["name"])]),_:1},8,["modelValue","label"])]),_:1}),i(me,{modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=a=>S.value=a),items:R.value,"use-tab-panels":"","keep-alive":"",animated:!1,class:"q-ml-xs"},{ALL:s(()=>[p.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),k(C,null,_(p.value,(a,u)=>(o(),r(L,{key:`all-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:f},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(E,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),GROUP:s(()=>[p.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),k(C,null,_(M.value,(a,u)=>(o(),r(L,{key:`group-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:f},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(E,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),FAVORITE:s(()=>[B.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),k(C,null,_(B.value,(a,u)=>(o(),r(L,{key:`fav-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:f},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(E,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),_:1},8,["modelValue","items"])]),_:1}))}});export{Ae as default};
