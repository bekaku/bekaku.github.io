import{l as Q,u as z,r as d,d9 as F,y as W,br as X,o as j,c as b,a2 as q,m as r,n as o,w as s,x as i,bt as J,T as K,bv as Y,L as Z,M as ee,J as l,a0 as te,c_ as ae,aE as se,az as h,bj as oe,bf as g,R as C,W as k,X as _,da as I,bK as ie}from"./index-D_pQv8pS.js";import{C as E}from"./ChatHistoryItem-K3tmluxO.js";import{u as le}from"./chatStore-1lKNcnCX.js";import{B as ne}from"./BaseButton-Dqt7G8pG.js";import{B as re}from"./BaseCard-BjH6c4uf.js";import{B as ce}from"./BaseDropdownMenu-CKfowtr8.js";import{_ as ue}from"./BaseInput.vue_vue_type_script_setup_true_lang-CMjKUqvY.js";import{_ as L}from"./BaseResult.vue_vue_type_script_setup_true_lang-PpqeFt5W.js";import{_ as N}from"./BaseScrollArea.vue_vue_type_script_setup_true_lang-BXg_Y2-y.js";import{B as me}from"./BaseTabs-DXX2BjH0.js";import"./ClosePopup-DKr1Zozv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseAvatar-BF28hcaK.js";import"./FileManagerService-BV_Dzq56.js";import"./useAxios-QRQbEkIG.js";import"./BaseLabelValueItem.vue_vue_type_script_setup_true_lang-CgU4wGTR.js";import"./BaseTooltip.vue_vue_type_script_setup_true_lang-6D6Gst-Q.js";const Be=Q({__name:"ChatLeft",props:{groupItem:{},height:{},showClose:{type:Boolean,default:!1},autoDetect:{type:Boolean,default:!0}},emits:["on-item-click","on-close"],setup(A,{emit:O}){const{t:n}=z(),m=le(),x=O,S=d("ALL"),R=d([{label:n("chats.all"),value:"ALL"},{label:n("chats.groups"),value:"GROUP"},{label:n("chats.favorite"),value:"FAVORITE"}]),c=d([...F.dataList]),v=d();d(!1),d("PERSONAL");const V=d([{label:n("chats.addNewprivateChat"),icon:W,value:"PERSONAL"},{label:n("chats.groupChatCreate"),icon:X,value:"GROUP"}]);j(async()=>{A.autoDetect&&P()});const f=b(()=>{const e=v.value?.toString().trim();return e?c.value.filter(t=>t.groupName&&t.groupName.toLowerCase().includes(e.toLowerCase())):c.value}),M=b(()=>f.value.filter(e=>e.chatType=="GROUP")),w=b(()=>f.value.filter(e=>e.favorite)),P=()=>{if(c.value&&c.value.length>0){const e=c.value[0];e&&p(e)}},U=e=>{console.log("onMenuClick",e)},p=e=>{x("on-item-click",e)},$=e=>{console.log("onUpdatesearch",e)},B=e=>c.value.findIndex(t=>t.id==e),y=e=>c.value[e],D=async()=>{const e=await ie(c.value,"pin","desc");c.value=e},H=e=>{e!=null&&e>=0&&y(e)&&c.value.splice(e,1)},T=async(e,t=!0)=>{if(e){const a=B(e);if(a>=0){const u=y(a);u&&u.id&&(u.totalNewMessage=0)}}},G=()=>{if(!m?.chatId||!m?.chatSettingType){m.clearSetting();return}const e=B(m.chatId);if(e>=0){const t=y(e);if(t)switch(m.chatSettingType){case"NOTIFICATION":t.muteNotify=!t.muteNotify;break;case"PIN":t.pin=!t.pin,D();break;case"FAVORITE":t.favorite=!t.favorite;break;case"LEAVE":H(e);break;case"CLEAR_NEW_MESSAGE_NUMBER":t.totalNewMessage>0&&t.id&&T(t.id,!0);break;case"CLEAR_NEW_MESSAGE_NUMBER_ONLY":t.id&&T(t.id,!1);break}}m.clearSetting()};return q(m,e=>{e.toggleChatSetting&&G()}),(e,t)=>(o(),r(re,{flat:"",bordered:!1},{default:s(()=>[i(J,null,{default:s(()=>[i(Y,{class:"text-weight-bold"},{default:s(()=>[Z(ee(l(n)("chats.chats")),1)]),_:1}),e.showClose?(o(),r(ne,{key:0,flat:"",round:"",icon:l(te),onClick:t[0]||(t[0]=a=>e.$emit("on-close"))},null,8,["icon"])):K("",!0),i(ce,{items:V.value,tooltip:l(n)("chats.addNewChat"),icon:l(ae),onOnClick:U},null,8,["items","tooltip","icon"])]),_:1}),i(se,null,{default:s(()=>[i(ue,{modelValue:v.value,"onUpdate:modelValue":[t[1]||(t[1]=a=>v.value=a),$],label:l(n)("base.search"),debounce:250},{prepend:s(()=>[i(h,{name:l(oe)},null,8,["name"])]),_:1},8,["modelValue","label"])]),_:1}),i(me,{modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=a=>S.value=a),items:R.value,"use-tab-panels":"","keep-alive":"",animated:!1,class:"q-ml-xs"},{ALL:s(()=>[f.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),C(k,null,_(f.value,(a,u)=>(o(),r(E,{key:`all-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:p},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(L,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),GROUP:s(()=>[f.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),C(k,null,_(M.value,(a,u)=>(o(),r(E,{key:`group-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:p},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(L,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),FAVORITE:s(()=>[w.value.length>0?(o(),r(g,{key:0},{default:s(()=>[i(N,{height:"61vh"},{default:s(()=>[(o(!0),C(k,null,_(w.value,(a,u)=>(o(),r(E,{key:`fav-${a.id}-${u}`,item:a,"is-active":e.groupItem?.id==a.id,onOnItemClick:p},null,8,["item","is-active"]))),128))]),_:1})]),_:1})):(o(),r(L,{key:1,status:"empty",description:l(n)("chats.chatHistoryEmpty"),"show-icon":!1},{extra:s(()=>[i(h,{name:l(I),size:"70px",class:"text-muted"},null,8,["name"])]),_:1},8,["description"]))]),_:1},8,["modelValue","items"])]),_:1}))}});export{Be as default};
