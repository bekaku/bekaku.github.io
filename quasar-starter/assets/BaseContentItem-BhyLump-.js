import{l as U,ds as M,a as P,u as q,r as a,o as D,h as _,dt as A,du as N,R as g,T as c,n as r,v as y,b8 as O,m as k,b9 as R,I as v,J as E,i as V,a3 as z}from"./index-5wxfv7l2.js";import{_ as F}from"./BaseContentHtml.vue_vue_type_script_setup_true_lang-BkmH68SH.js";import{B as J}from"./BaseButton-DzqSnquD.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G=["id"],K=U({__name:"BaseContentItem",props:{contentId:{default:"content-id"},content:{},wrapText:{type:Boolean,default:!0},to:{},openPage:{type:Boolean,default:!0},showCopyText:{type:Boolean,default:!0},showMore:{type:Boolean,default:!0},showBackground:{type:Boolean,default:!1},canUrlify:{type:Boolean,default:!0},hashtagUrlify:{type:Boolean,default:!1},limit:{default:4},fitContent:{type:Boolean,default:!1},linkStyle:{default:"app-text-link"},textStyle:{default:"q-text-black"},isEscapeHtml:{type:Boolean,default:!1},highLightText:{}},setup(B){M(e=>({c2d34b5e:e.limit}));const t=B,{appNavigateTo:u}=P(),{t:$}=q(),f=a(0),i=a(!1),s=a(!1),l=a(),I=a(!1);D(()=>{L()});const L=()=>{l.value=setTimeout(()=>{x(),t.canUrlify&&T(),I.value=!0},50)},T=()=>{document.querySelectorAll(`.content-href-${t.contentId}`).forEach(n=>{n.addEventListener("click",h)}),t.hashtagUrlify&&document.querySelectorAll(`.hashtag-href-${t.contentId}`).forEach(o=>{o.addEventListener("click",d)})},w=()=>{document.querySelectorAll(`.content-href-${t.contentId}`).forEach(o=>{o.removeEventListener("click",h)}),document.querySelectorAll(`.hashtag-href-${t.contentId}`).forEach(o=>{o.removeEventListener("click",d)})};_(()=>{l.value&&(clearTimeout(l.value),l.value=null),w(),s.value=!1});const h=e=>{if(e.target.classList.contains(`content-href-${t.contentId}`)){if(e.srcElement&&e.srcElement.href){const n=e.srcElement.href;A(n,e)}e.stopPropagation(),e.preventDefault()}},d=e=>{if(e.target.classList.contains(`hashtag-href-${t.contentId}`)){if(e.srcElement&&e.srcElement.innerText){const n=e.srcElement.innerText;n&&u(`/hashtag/${n.replace("#","")}`)}e.stopPropagation(),e.preventDefault()}},x=()=>{if(t.wrapText){const e=document.getElementById(t.contentId);if(e){const o=e.offsetHeight/20;f.value=N(o,0),f.value>t.limit&&(i.value=!0)}}},C=(e,n=void 0)=>{const o=t.isEscapeHtml?z(e):e;if(t.canUrlify){const H=/(https?:\/\/\S+)/g,p=o.replace(H,m=>`<a class="content-href-${t.contentId} ${t.linkStyle} ${n||""}" href="${m}">${m}</a>`);return t.hashtagUrlify?p.replace(/#([\p{L}\p{N}_\u0E00-\u0E7F]+)/gu,`<a class="hashtag-href-${t.contentId} ${t.linkStyle} ${n||""}">#$1</a>`):p}return o},S=e=>{t.to&&u(t.to),e.stopImmediatePropagation()},b=async()=>{s.value=!0};return(e,n)=>e.content?(r(),g("div",{key:0,style:{overflow:"hidden"},class:v({"text-holder-fitcontent":!E(V)(e.content)&&e.fitContent})},[y(e.$slots,"top",{},void 0,!0),O((r(),g("div",{id:e.contentId||"content-id",class:v([{"word-limit":i.value&&!s.value,"cursor-pointer":e.to},"app-auto-newline dont-break-out text-holder"])},[e.content!=null?(r(),k(F,{key:0,content:C(e.content,"text-primary"),"high-light-text":e.highLightText,onOnPress:n[0]||(n[0]=o=>S(o))},null,8,["content","high-light-text"])):c("",!0)],10,G)),[[R]]),i.value&&!s.value?(r(),k(J,{key:0,flat:"",dense:"",label:E($)("base.seeMore"),onClick:b},null,8,["label"])):c("",!0),y(e.$slots,"bottom",{},void 0,!0)],2)):c("",!0)}}),Z=j(K,[["__scopeId","data-v-ff6a65f0"]]);export{Z as C};
