const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SkeletonItem-azHwWjXe.js","assets/SkeletonItem.vue_vue_type_script_setup_true_lang-0IBgYadc.js","assets/index-IHG1WLnI.js","assets/index-Fr33gqm_.css","assets/BaseResult-Bl1h63DL.js","assets/BaseResult.vue_vue_type_script_setup_true_lang-hsN0pICM.js"])))=>i.map(i=>d[i]);
import{em as g,bZ as k,r as p,en as A,o as B,l as P,u as E,m as d,n as y,w as l,a3 as I,x as N,J as o,dS as L,L as h,M as _,Q as M,bS as b,ar as x,aB as w,t as O,aC as C,b8 as Q,a7 as T,eo as D,aK as R}from"./index-IHG1WLnI.js";import{C as V}from"./ClosePopup-DyOSBGnb.js";import{u as F}from"./useAxios-B0sgnEOm.js";const S=()=>(F(),{updateFcmSetting:async s=>{},refreshFcmToken:async s=>{},findAllByUser:async(s,n)=>new Promise(t=>{setTimeout(()=>{t([])},1500)}),findCountAllNotRead:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotify:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotifyAll:async()=>new Promise(s=>{setTimeout(()=>{s(null)},500)})}),U=g("notificationStore",()=>{const{cacheNotifyCount:f}=k(),a=p({lastestId:0,totalNotify:0});return{notify:a,setNotify:e=>{a.value.totalNotify=e.totalNotify,a.value.lastestId=e.lastestId},setLastNotify:e=>{f.value.lastestId=e}}}),K=()=>{const{findCountAllNotRead:f}=S(),{cacheNotifyCount:a}=k(),r=U(),{notify:i}=A(r),{setNotify:e}=r;return B(()=>{i.value.totalNotify=999}),{notify:i,setNotify:e,resetBadgeCount:()=>{i.value.totalNotify=0},notificationLink:(t,c)=>{if(t&&c){if(t=="LIKE_POST"||t=="SHARE"||t=="COMMENT_POST")return`/post/view/${c}`;if(t=="LIKE_COMMENT")return`/comment/view/${c}`;if(t=="COMMENT_REPLY")return`/comment/view/${c}?isReply=1`}},fetchNotReadNotify:async()=>{const t=await f(a.value&&a.value.lastestId?a.value.lastestId:0);t&&t.lastestId&&t.totalNotify&&e(t)}}},$={class:"text-h6"},Y=P({__name:"NotificationBarMenu",setup(f){const a=C(()=>R(()=>import("./SkeletonItem-azHwWjXe.js"),__vite__mapDeps([0,1,2,3]))),r=C(()=>R(()=>import("./BaseResult-Bl1h63DL.js"),__vite__mapDeps([4,5,2,3]))),{findAllByUser:i}=S(),{t:e}=E(),u=p(!1),s=p([]),{notify:n,resetBadgeCount:t}=K();B(async()=>{u.value=!0,await c(),u.value=!1});const c=async()=>{const m=await i(1,10);return m&&m.length>0&&s.value.push(...m),new Promise(v=>{v(!0)})};return(m,v)=>(y(),d(T,{round:"",dense:"",flat:"",onClick:o(t),icon:o(D)},{default:l(()=>[o(n)&&o(n).totalNotify?(y(),d(L,{key:0,color:"negative",rounded:"","text-color":"white",floating:""},{default:l(()=>[h(_(o(n).totalNotify>99?"99+":o(n).totalNotify),1)]),_:1})):I("",!0),N(M,null,{default:l(()=>[h(_(o(e)("nav.notifications")),1)]),_:1}),N(b,{anchor:"bottom left",self:"top left",style:{width:"360px"}},{default:l(()=>[N(x,{flat:""},{default:l(()=>[N(w,null,{default:l(()=>[O("div",$,_(o(e)("base.notification")),1)]),_:1}),u.value?(y(),d(o(a),{key:0,items:5,show:""})):s.value.length>0?(y(),d(w,{key:1},{default:l(()=>[Q(N(T,{unelevated:"",rounded:"",color:"primary",class:"full-width",label:o(e)("base.readAllNotifications"),to:"/notifications"},null,8,["label"]),[[V]])]),_:1})):(y(),d(o(r),{key:2,status:"empty",description:o(e)("error.dataNotfound")},null,8,["description"]))]),_:1})]),_:1})]),_:1},8,["onClick","icon"]))}});export{Y as default};
