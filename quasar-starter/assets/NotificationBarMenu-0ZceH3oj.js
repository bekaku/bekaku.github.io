const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SkeletonItem-DirGRtsV.js","assets/SkeletonItem.vue_vue_type_script_setup_true_lang-C9i1fiUb.js","assets/index-BUKV_9O1.js","assets/index-Fr33gqm_.css","assets/BaseResult-BxVjDszv.js","assets/BaseResult.vue_vue_type_script_setup_true_lang-YQvm5QEs.js"])))=>i.map(i=>d[i]);
import{ek as g,bU as B,r as p,el as S,o as R,l as P,u as E,m as d,n as y,w as l,a0 as I,x as N,a5 as o,dS as L,W as h,X as _,a7 as x,cB as M,aq as b,aA as w,t as O,aB as T,b7 as D,a4 as C,em as Q,aJ as k}from"./index-BUKV_9O1.js";import{C as V}from"./ClosePopup-DPKYBDjj.js";import{u as U}from"./useAxios-578BH76m.js";const A=()=>(U(),{updateFcmSetting:async s=>{},refreshFcmToken:async s=>{},findAllByUser:async(s,n)=>new Promise(t=>{setTimeout(()=>{t([])},1500)}),findCountAllNotRead:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotify:async s=>new Promise(n=>{setTimeout(()=>{n(null)},500)}),updateReadNotifyAll:async()=>new Promise(s=>{setTimeout(()=>{s(null)},500)})}),F=g("notificationStore",()=>{const{cacheNotifyCount:f}=B(),a=p({lastestId:0,totalNotify:0});return{notify:a,setNotify:e=>{a.value.totalNotify=e.totalNotify,a.value.lastestId=e.lastestId},setLastNotify:e=>{f.value.lastestId=e}}}),$=()=>{const{findCountAllNotRead:f}=A(),{cacheNotifyCount:a}=B(),r=F(),{notify:i}=S(r),{setNotify:e}=r;return R(()=>{i.value.totalNotify=999}),{notify:i,setNotify:e,resetBadgeCount:()=>{i.value.totalNotify=0},notificationLink:(t,c)=>{if(t&&c){if(t=="LIKE_POST"||t=="SHARE"||t=="COMMENT_POST")return`/post/view/${c}`;if(t=="LIKE_COMMENT")return`/comment/view/${c}`;if(t=="COMMENT_REPLY")return`/comment/view/${c}?isReply=1`}},fetchNotReadNotify:async()=>{const t=await f(a.value&&a.value.lastestId?a.value.lastestId:0);t&&t.lastestId&&t.totalNotify&&e(t)}}},K={class:"text-h6"},J=P({__name:"NotificationBarMenu",setup(f){const a=T(()=>k(()=>import("./SkeletonItem-DirGRtsV.js"),__vite__mapDeps([0,1,2,3]))),r=T(()=>k(()=>import("./BaseResult-BxVjDszv.js"),__vite__mapDeps([4,5,2,3]))),{findAllByUser:i}=A(),{t:e}=E(),u=p(!1),s=p([]),{notify:n,resetBadgeCount:t}=$();R(async()=>{u.value=!0,await c(),u.value=!1});const c=async()=>{const m=await i(1,10);return m&&m.length>0&&s.value.push(...m),new Promise(v=>{v(!0)})};return(m,v)=>(y(),d(C,{round:"",dense:"",flat:"",onClick:o(t),icon:o(Q)},{default:l(()=>[o(n)&&o(n).totalNotify?(y(),d(L,{key:0,color:"negative",rounded:"","text-color":"white",floating:""},{default:l(()=>[h(_(o(n).totalNotify>99?"99+":o(n).totalNotify),1)]),_:1})):I("",!0),N(x,null,{default:l(()=>[h(_(o(e)("nav.notifications")),1)]),_:1}),N(M,{anchor:"bottom left",self:"top left",style:{width:"360px"}},{default:l(()=>[N(b,{flat:""},{default:l(()=>[N(w,null,{default:l(()=>[O("div",K,_(o(e)("base.notification")),1)]),_:1}),u.value?(y(),d(o(a),{key:0,items:5,show:""})):s.value.length>0?(y(),d(w,{key:1},{default:l(()=>[D(N(C,{unelevated:"",rounded:"",color:"primary",class:"full-width",label:o(e)("base.readAllNotifications"),to:"/notifications"},null,8,["label"]),[[V]])]),_:1})):(y(),d(o(r),{key:2,status:"empty",description:o(e)("error.dataNotfound")},null,8,["description"]))]),_:1})]),_:1})]),_:1},8,["onClick","icon"]))}});export{J as default};
