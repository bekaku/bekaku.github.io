import{d as S,_ as A,B as _,H as P,ai as M,aW as j,aK as N,F as i,ah as y,aB as T,u as Y,a as Z,aC as O,r as g,b1 as G,dY as J,dZ as D,d_ as $,aH as ee,d$ as le,e0 as ie,e1 as oe,ak as H,I as p,E as r,ab as te,ac as x,N as ae,aV as ne,O as k,R as se,af as re,b8 as X,C as w,bV as de,dH as me,dI as ce,al as ue,am as fe,au as ve,e2 as q,e3 as pe,e4 as Fe,cy as _e,cx as be,bO as ge,L as Pe,M as L,a7 as we,a8 as Ie,a9 as ke,aa as R,$ as ye,aZ as Se,ag as Ae,S as he}from"./index-CtshLCu5.js";import{U as Ce}from"./Button-D7XxUIly.js";import{F as Ue,a as xe}from"./FilesPreviewItemAlt-C_edZE2b.js";import{z as Re,n as Be,g as Ve}from"./FileManagerService-DNigZnkW.js";import{u as ze}from"./useAppMeta-CG3d98BT.js";import{B as Qe}from"./BaseAvatar-Bae55L9s.js";import"./AppImage-BjMpvwbi.js";import"./useAxios-COXRH2J2.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./use-meta-CxFHv_gx.js";const Ee=S({__name:"FilesPreview",props:{showDelete:{type:Boolean,default:!0},col:{default:"col-3 q-pa-md"},items:{},formatSize:{type:Boolean}},emits:["on-remove"],setup(u,{expose:l,emit:o}){l();const e=o,c={emit:e,onRemove:n=>{e("on-remove",n)},FilesPreviewItem:Ue};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),Te={key:0,class:"row"};function Oe(u,l,o,e,v,c){return o.items.length>0?(_(),P("div",Te,[(_(!0),P(M,null,j(o.items,(n,d)=>(_(),P("div",{class:N([o.col,"div-style q-pa-md"]),key:`f-${d}-${n.fileName}`},[i(e.FilesPreviewItem,{item:n,index:d,onOnRemove:e.onRemove,"show-delete":o.showDelete,"format-size":o.formatSize},null,8,["item","index","show-delete","format-size"])],2))),128))])):y("",!0)}const K=A(Ee,[["render",Oe],["__file","FilesPreview.vue"]]),qe=S({__name:"FilePicker",props:T({multiple:{type:Boolean,default:!1},showPreview:{type:Boolean,default:!0},icon:{default:J},label:{},accept:{default:D},wildcard:{type:Boolean},maxFiles:{default:$}},{modelValue:{default:()=>[]},modelModifiers:{},fileItems:{default:()=>[]},fileItemsModifiers:{}}),emits:T(["onFileAdd"],["update:modelValue","update:fileItems"]),setup(u,{expose:l,emit:o}){const e=u,{appToast:v}=Y(),{t:c}=Z(),n=O(u,"modelValue"),d=O(u,"fileItems"),F=g([]),s=o,f=g(),b=()=>{if(e.maxFiles>0&&n.value&&n.value.length==e.maxFiles){v(c("error.limitFile2",{total:e.maxFiles}),{type:"negative"});return}f.value&&f.value.$el.click()},B=a=>{a&&a.stopPropagation(),n.value=[],F.value=[]},V=a=>{v(c("error.filesValidationFmt",{total:a.length}),{type:"negative"})},h=async a=>{const t=[];for(const m of a){const W=m.type;if(m.size>le)v(c("error.limitEachFile2",[m.name,ie]),{multiLine:!1,type:"negative"});else if(oe.includes(W))t.push(m);else{const E=await Re(m);E&&t.push(E)}}return new Promise(m=>{m(t)})},z=async a=>{const t=await h(a);if(s("onFileAdd",t),e.multiple){if(t&&t.length>0)for(const m of t)await I(m)}else t&&(n.value=[],d.value=[],await I(t));F.value=[]},I=async a=>{const t=Be(a);let m;t&&(m=await Ve(a)),C(a,t,m)},C=(a,t,m=void 0)=>{n.value&&(n.value.push(a),d.value.push({id:0,fileMime:a.type,fileName:a.name,filePath:m||"",fileThumbnailPath:"",fileSize:a.size+"",functionId:0,isImage:t,file:a}))},Q=a=>{n.value&&(n.value.splice(a,1),d.value.splice(a,1))};G(()=>{n.value=[],d.value=[],F.value=[]}),l({openFilePicker:b});const U={props:e,appToast:v,t:c,modelValue:n,fileItems:d,modelImageFiles:F,emit:s,appFileInputRef:f,openFilePicker:b,onClear:B,onRejected:V,validateAndZipFile:h,onFileAdded:z,onAddFile:I,onAddFilePreview:C,onRemoveNewImage:Q,get biX(){return ee},FilesPreview:K};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),Le={class:"row"},Me={key:0,class:"col-12 col-md-8 q-pa-md"};function je(u,l,o,e,v,c){return _(),P("div",me(ce(u.$attrs)),[H(u.$slots,"default",{},()=>[p("div",Le,[p("div",{class:N(["col-12 q-pa-md",{"col-md-4":o.showPreview}])},[i(X,{bordered:"",class:"app-border-radius"},{default:r(()=>[i(te,{clickable:"",onClick:e.openFilePicker},{default:r(()=>[i(x,{avatar:""},{default:r(()=>[i(ae,{name:o.icon},null,8,["name"])]),_:1}),i(x,null,{default:r(()=>[i(ne,null,{default:r(()=>[k(se(o.label?o.label:e.t("base.chooseFile")),1)]),_:1})]),_:1}),i(x,{side:""},{default:r(()=>[i(re,{onClick:e.onClear,round:"",flat:"",icon:e.biX},null,8,["icon"])]),_:1})]),_:1})]),_:1})],2),o.showPreview?(_(),P("div",Me,[e.fileItems.length>0&&e.modelValue&&e.modelValue.length>0?(_(),w(e.FilesPreview,{key:0,items:e.fileItems,onOnRemove:e.onRemoveNewImage,"format-size":""},null,8,["items"])):y("",!0)])):y("",!0)])]),i(de,{style:{display:"none"},ref:"appFileInputRef",filled:"","max-files":o.maxFiles,"bottom-slots":"",modelValue:e.modelImageFiles,"onUpdate:modelValue":[l[0]||(l[0]=n=>e.modelImageFiles=n),e.onFileAdded],label:o.label?o.label:e.t("base.chooseFile"),counter:"",multiple:o.multiple,accept:o.wildcard?void 0:o.accept,onRejected:e.onRejected},null,8,["max-files","modelValue","label","multiple","accept"])],16)}const Ne=A(qe,[["render",je],["__file","FilePicker.vue"]]),Ze=S({__name:"ScrollArea",props:{height:{default:"420px"}},setup(u,{expose:l}){l();const o={};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}});function De(u,l,o,e,v,c){return _(),w(fe,{style:ue({height:o.height}),"content-active-style":"width: 100%;","content-style":"width: 100%;"},{default:r(()=>[H(u.$slots,"default")]),_:3},8,["style"])}const He=A(Ze,[["render",De],["__file","ScrollArea.vue"]]),Xe=S({__name:"file-picker",setup(u,{expose:l}){l();const o=ve(),{t:e}=Z(),{setTitle:v}=ze();v(`File picker | ${e("app.name")}`);const c=g([]),n=g([]),d=q("filePickerCustomUiRef"),F=g([]),s=q("filePickerCustomUi2Ref"),f=g([]),b=g(),a={authenStore:o,t:e,setTitle:v,files:c,filesPreview:n,filePickerCustomUiRef:d,customFiles:F,filePickerCustomUi2Ref:s,custom2Files:f,message:b,onFileAdd:t=>{console.log("onFildAdd",t)},onSubmit:()=>{console.log("onSubmit",c.value,"filesPreview",n.value)},openPicker:()=>{d.value&&d.value.openFilePicker()},onCustomFileAdd:t=>{console.log("onCustomFileAdd",t)},onCustomRemove:t=>{F.value&&F.value.splice(t,1)},openPicker2:()=>{s.value&&s.value.openFilePicker()},onCustomFileAdd2:t=>{console.log("onCustomFileAdd",t)},onCustomRemove2:t=>{f.value&&f.value.splice(t,1)},UiButton:Ce,UiFilePicker:Ne,UiScrollArea:He,get FileExtensionAccept(){return D},get biFileArrowUp(){return pe},get biUpload(){return Fe},get biSend(){return _e},get biEmojiSmile(){return be},get biImage(){return ge},BaseAvatar:Qe,FilesPreview:K,FilesPreviewItemAlt:xe};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),Ke={class:"row"},We={class:"col-12 q-pa-md"},Ye={class:"col-12 q-pa-md"},Ge={class:"col-12 q-pa-md"},Je={class:"row"},$e={class:"col-12 col-md-6 q-pa-md"},el={class:"col-12 col-md-6 q-pa-md"};function ll(u,l,o,e,v,c){return _(),w(Pe,{padding:""},{default:r(()=>[i(he,{flat:"",bordered:"",class:"content-limit"},{default:r(()=>[i(L,null,{default:r(()=>[i(we,null,{default:r(()=>[i(Ie,null,{default:r(()=>l[5]||(l[5]=[k(" file-picker ")])),_:1}),i(ke)]),_:1}),i(R)]),_:1}),i(L,null,{default:r(()=>{var n,d,F;return[p("div",Ke,[p("div",We,[l[7]||(l[7]=p("div",{class:"text-h5"}," Simple Picker ",-1)),i(e.UiFilePicker,{multiple:"",modelValue:e.files,"onUpdate:modelValue":l[0]||(l[0]=s=>e.files=s),fileItems:e.filesPreview,"onUpdate:fileItems":l[1]||(l[1]=s=>e.filesPreview=s),icon:e.biFileArrowUp,"show-preview":"",accept:e.FileExtensionAccept,onOnFileAdd:e.onFileAdd,label:e.t("base.chooseFile")},null,8,["modelValue","fileItems","icon","accept","label"]),i(e.UiButton,{class:"q-my-md",onClick:e.onSubmit},{default:r(()=>l[6]||(l[6]=[k(" Submit ")])),_:1}),i(R)]),p("div",Ye,[l[8]||(l[8]=p("div",{class:"text-h5"}," Custom Ui ",-1)),i(e.UiFilePicker,{ref:"filePickerCustomUiRef",multiple:"",fileItems:e.customFiles,"onUpdate:fileItems":l[2]||(l[2]=s=>e.customFiles=s),accept:e.FileExtensionAccept,onOnFileAdd:e.onCustomFileAdd},{default:r(()=>[i(e.UiButton,{class:"q-my-md",onClick:e.openPicker,outline:"",icon:e.biUpload,label:"Open Picker"},null,8,["icon"])]),_:1},8,["fileItems","accept"]),i(e.FilesPreview,{items:e.customFiles,onOnRemove:e.onCustomRemove,"format-size":"",col:"col-4 col-md-2 q-pa-md"},null,8,["items"]),i(R)]),p("div",Ge,[l[10]||(l[10]=p("div",{class:"text-h5 q-pb-md"}," Custom Ui2 ",-1)),p("div",Je,[p("div",$e,[i(e.UiFilePicker,{style:{display:"none"},ref:"filePickerCustomUi2Ref",multiple:"",fileItems:e.custom2Files,"onUpdate:fileItems":l[3]||(l[3]=s=>e.custom2Files=s),accept:e.FileExtensionAccept,"max-files":5,onOnFileAdd:e.onCustomFileAdd2},null,8,["fileItems","accept"]),i(ye,{outlined:"",modelValue:e.message,"onUpdate:modelValue":l[4]||(l[4]=s=>e.message=s),type:"textarea",autogrow:"",label:"Type message"},Se({before:r(()=>[i(e.UiButton,{round:"",flat:"",icon:e.biImage,color:"grey-7",onClick:e.openPicker2},null,8,["icon"]),i(e.UiButton,{round:"",flat:"",icon:e.biEmojiSmile,color:"grey-7"},null,8,["icon"])]),after:r(()=>[i(e.UiButton,{flat:"",round:"",icon:e.biSend,color:"primary"},{default:r(()=>[i(Ae,null,{default:r(()=>l[9]||(l[9]=[k(" Send ")])),_:1})]),_:1},8,["icon"])]),_:2},[(F=(d=(n=e.authenStore)==null?void 0:n.auth)==null?void 0:d.avatar)!=null&&F.thumbnail?{name:"prepend",fn:r(()=>{var s,f,b;return[i(e.BaseAvatar,{src:(b=(f=(s=e.authenStore)==null?void 0:s.auth)==null?void 0:f.avatar)==null?void 0:b.thumbnail},null,8,["src"])]}),key:"0"}:void 0]),1032,["modelValue"])]),p("div",el,[e.custom2Files!=null&&e.custom2Files.length>0?(_(),w(X,{key:0},{default:r(()=>[i(e.UiScrollArea,{height:"250px"},{default:r(()=>[(_(!0),P(M,null,j(e.custom2Files,(s,f)=>(_(),w(e.FilesPreviewItemAlt,{key:`f-${s.id}-${f}`,item:s,index:f,onOnRemove:e.onCustomRemove2,dense:"","format-size":"","image-size":"100px","show-delete":""},null,8,["item","index"]))),128))]),_:1})]),_:1})):y("",!0)])])])])]}),_:1})]),_:1})]),_:1})}const fl=A(Xe,[["render",ll],["__file","file-picker.vue"]]);export{fl as default};
