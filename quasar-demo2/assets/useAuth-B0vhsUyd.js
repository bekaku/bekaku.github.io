import{aG as w,aH as D,u as q,a as K,aI as l,aJ as i,aK as p,aL as g,aM as S,aN as O,P as V,aO as u}from"./index-DDZXG7TO.js";import{u as E,a as I}from"./useAxios-Oymy46L5.js";const L=()=>{const{callAxios:s,callAxiosProcess:n}=E();return{singin:async t=>new Promise(a=>{setTimeout(()=>{a(w)},1500)}),singoutToServer:async t=>new Promise(a=>{setTimeout(()=>{a({status:"OK",timestamp:""})},1500)}),refreshToken:async t=>new Promise(a=>{setTimeout(()=>{a(w)},1500)}),removeAccessTokenSession:async t=>await s({API:`/api/auth/removeAccessTokenSession?id=${t}`,method:"DELETE"}),requestVerifyCodeToResetPwd:async t=>await n({API:"/api/auth/requestVerifyCodeToResetPwd",method:"POST",body:{forgotPasswordRequest:t}}),sendVerifyCodeToResetPwd:async t=>await n({API:"/api/auth/sendVerifyCodeToResetPwd",method:"POST",body:{forgotPasswordRequest:t}}),resetPassword:async t=>await n({API:"/api/auth/resetPassword",method:"POST",body:{forgotPasswordRequest:t}})}},M=()=>{const s=V,n=D(),{appConfirm:d,appLoading:c,isDevMode:m}=q(),{t:h}=K(),{singoutToServer:A}=L(),{logoutClear:f}=I(),T=()=>{},t=e=>s&&s.get(e)||null,a=e=>{e!=null&&n.setAuthen(e)},k=async()=>{var r;if(!s)return;if(await d(h("app.monogram"),h("helper.logoutConfirm"))){c();const o=t(p),R=(r=n.auth)==null?void 0:r.email;await P(o,R),c(!1),y()}},C=e=>{v(s,e,!m())},v=(e,r,o=!1)=>{e&&(e.set(l,r.authenticationToken,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(p,r.refreshToken,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(g,r.expiresAt,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(S,Date.now().toString(),{expires:i(u),path:"/",secure:o,sameSite:"Strict"}))},P=async(e,r)=>!e||!r?new Promise(o=>{o(!0)}):(await A({refreshToken:{refreshToken:e,email:r}}),new Promise(o=>{o(!0)})),x=()=>new Promise(e=>{s&&(s.remove(l,{path:"/"}),s.remove(p,{path:"/"}),s.remove(g,{path:"/"}),s.remove(S,{path:"/"})),f(),e(!0)}),y=async(e=!0)=>{await x(),n.logout(),e&&window.location.replace(`${O}/auth/login`)};return{initAppAuthen:T,signOut:k,setAuthen:a,destroyAuthDataAndRedirect:y,setAuthenticationCookies:C,logoutToServer:P}};export{L as A,M as u};
