import{at as P,au as D,u as q,a as V,av as l,aw as i,ax as d,ay as g,az as S,P as E,aA as u}from"./index-C1BRECWX.js";import{u as I,a as K}from"./useAxios-Com3o9vK.js";const O=()=>{const{callAxios:s,callAxiosProcess:n}=I();return{singin:async t=>new Promise(a=>{setTimeout(()=>{a(P)},1500)}),singoutToServer:async t=>await s({API:"/api/auth/logout",method:"POST",body:t}),refreshToken:async t=>new Promise(a=>{setTimeout(()=>{a(P)},1500)}),removeAccessTokenSession:async t=>await s({API:`/api/auth/removeAccessTokenSession?id=${t}`,method:"DELETE"}),requestVerifyCodeToResetPwd:async t=>await n({API:"/api/auth/requestVerifyCodeToResetPwd",method:"POST",body:{forgotPasswordRequest:t}}),sendVerifyCodeToResetPwd:async t=>await n({API:"/api/auth/sendVerifyCodeToResetPwd",method:"POST",body:{forgotPasswordRequest:t}}),resetPassword:async t=>await n({API:"/api/auth/resetPassword",method:"POST",body:{forgotPasswordRequest:t}})}},L=()=>{const s=E,n=D(),{appConfirm:p,appLoading:c,isDevMode:A}=q(),{t:h}=V(),{singoutToServer:m}=O(),{logoutClear:f}=K(),y=()=>{},t=e=>s&&s.get(e)||null,a=e=>{e!=null&&n.setAuthen(e)},k=async()=>{var r;if(!s)return;if(await p(h("app.monogram"),h("helper.logoutConfirm"))){c();const o=t(d),R=(r=n.auth)==null?void 0:r.email;await T(o,R),c(!1),w()}},C=e=>{v(s,e,!A())},v=(e,r,o=!1)=>{e&&(e.set(l,r.authenticationToken,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(d,r.refreshToken,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(g,r.expiresAt,{expires:i(u),path:"/",secure:o,sameSite:"Strict"}),e.set(S,Date.now().toString(),{expires:i(u),path:"/",secure:o,sameSite:"Strict"}))},T=async(e,r)=>!e||!r?new Promise(o=>{o(!0)}):(await m({refreshToken:{refreshToken:e,email:r}}),new Promise(o=>{o(!0)})),x=()=>new Promise(e=>{s&&(s.remove(l,{path:"/"}),s.remove(d,{path:"/"}),s.remove(g,{path:"/"}),s.remove(S,{path:"/"})),f(),e(!0)}),w=async(e=!0)=>{await x(),n.logout(),e&&window.location.replace("/auth/login")};return{initAppAuthen:y,signOut:k,setAuthen:a,destroyAuthDataAndRedirect:w,setAuthenticationCookies:C,logoutToServer:T}};export{O as A,L as u};
