const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotifyIcon-DBwlqY50.js","assets/index-DDZXG7TO.js","assets/index-HNifYG8Q.css"])))=>i.map(i=>d[i]);
import{ek as F,r as N,el as U,T as q,d as w,u as V,Y as j,Z as H,_ as A,B as l,C as d,E as a,F as n,ac as S,ad as D,ae as I,aE as B,O as p,R as h,aC as L,ab as z,ah as y,a as O,M as T,I as v,H as x,ai as R,aF as G,aq as K,af as _,S as Y,dK as Z,bw as J,ce as W,em as X,en as $,eo as ee,ep as te,bF as ae,eq as oe,N as P,a9 as ne,ag as b,cA as ie,bq as se,a7 as re,er as le}from"./index-DDZXG7TO.js";import{a as Q,u as ce}from"./useAxios-Oymy46L5.js";import{C as de}from"./ClosePopup-BEkvAfed.js";import fe from"./AppResult-Gk2Gg_cz.js";import ue from"./SkeletonItem-o4bxJXkX.js";const me=F("notificationStore",()=>{const{cacheNotifyCount:c}=Q(),o=N({lastestId:0,totalNotify:0});return{notify:o,setNotify:i=>{o.value.totalNotify=i.totalNotify,o.value.lastestId=i.lastestId},setLastNotify:i=>{c.value.lastestId=i}}}),C=()=>{const{callAxios:c}=ce();return{updateFcmSetting:async s=>{await c({API:"/api/userNotify/updateFcmSetting",method:"PUT",body:s})},refreshFcmToken:async s=>{await c({API:"/api/userNotify/refreshFcmToken",method:"PUT",body:s})},findAllByUser:async(s,r)=>new Promise(m=>{setTimeout(()=>{m([])},1500)}),findCountAllNotRead:async s=>await c({API:`/api/userNotify/findCountAllNotRead?lastestNotifyId=${s}`,method:"GET"}),updateReadNotify:async s=>await c({API:`/api/userNotify/updateReadNotify/${s}`,method:"PUT"}),updateReadNotifyAll:async()=>await c({API:"/api/userNotify/updateReadNotifyAll",method:"PUT"})}},M=()=>{const{findCountAllNotRead:c}=C(),{cacheNotifyCount:o}=Q(),t=me(),{notify:e}=U(t),{setNotify:i}=t;return q(()=>{e.value.totalNotify=999}),{notify:e,setNotify:i,resetBadgeCount:()=>{e.value.totalNotify=0},notificationLink:(r,m)=>{if(r&&m){if(r=="LIKE_POST"||r=="SHARE"||r=="COMMENT_POST")return`/post/view/${m}`;if(r=="LIKE_COMMENT")return`/comment/view/${m}`;if(r=="COMMENT_REPLY")return`/comment/view/${m}?isReply=1`}},fetchNotReadNotify:async()=>{const r=await c(o.value&&o.value.lastestId?o.value.lastestId:0);r&&r.lastestId&&r.totalNotify&&i(r)}}},ye=w({__name:"NotificationItem",props:{index:{type:Number},item:{type:Object,default:()=>null}},emits:["on:click"],setup(c,{expose:o,emit:t}){o();const e=j(()=>H(()=>import("./NotifyIcon-DBwlqY50.js"),__vite__mapDeps([0,1,2]))),i=c,{updateReadNotify:u}=C(),{notificationLink:f}=M(),{appFormatDateDistance:s,isDark:r}=V(),m=t,g={NotifyIcon:e,props:i,updateReadNotify:u,notificationLink:f,appFormatDateDistance:s,isDark:r,emit:m,onClick:()=>{i.item.readStatus||u(i.item.id),m("on:click",i.index)}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}});function _e(c,o,t,e,i,u){return t.item?(l(),d(z,{key:0,to:e.notificationLink(t.item.functionCode,t.item.functionId),onClick:e.onClick,class:L(e.isDark&&!t.item.readStatus?"bg-grey-9":t.item.readStatus?"":"bg-light-blue-2")},{default:a(()=>[n(S,{avatar:""},{default:a(()=>[n(D,{size:"48px"},{default:a(()=>{var f,s;return[t.item.fromUser?(l(),d(I,{key:0,src:(s=(f=t.item.fromUser)==null?void 0:f.avatar)==null?void 0:s.thumbnail,"spinner-color":"white","no-native-menu":""},null,8,["src"])):(l(),d(I,{key:1,src:"/icon.png","spinner-color":"white","no-native-menu":""}))]}),_:1})]),_:1}),n(S,null,{default:a(()=>[n(B,{lines:2},{default:a(()=>[p(h(t.item.message),1)]),_:1}),n(B,{caption:""},{default:a(()=>[p(h(e.appFormatDateDistance(t.item.createdDate)),1)]),_:1})]),_:1}),n(S,{side:""},{default:a(()=>[n(e.NotifyIcon,{"notify-type":t.item.functionCode,"emoji-type":t.item.emojiType},null,8,["notify-type","emoji-type"])]),_:1})]),_:1},8,["to","class"])):y("",!0)}const pe=A(ye,[["render",_e],["__scopeId","data-v-46377830"],["__file","NotificationItem.vue"]]),he=w({__name:"NotificationBarMenu",setup(c,{expose:o}){o();const{findAllByUser:t}=C(),{t:e}=O(),i=N(!1),u=N([]);q(async()=>{i.value=!0,await f(),i.value=!1});const f=async()=>{const r=await t(1,10);return r&&r.length>0&&u.value.push(...r),new Promise(m=>{m(!0)})},s={findAllByUser:t,t:e,loading:i,items:u,fetchDataData:f,AppResult:fe,NotificationItem:pe,SkeletonItem:ue};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),ge={class:"text-h6"};function Ne(c,o,t,e,i,u){return l(),d(Y,{flat:""},{default:a(()=>[n(T,null,{default:a(()=>[v("div",ge,h(e.t("base.notification")),1)]),_:1}),e.loading?(l(),d(e.SkeletonItem,{key:0,items:5,show:""})):e.items.length>0?(l(),x(R,{key:1},[(l(!0),x(R,null,G(e.items,(f,s)=>(l(),d(e.NotificationItem,{key:`notification-${f.id}`,item:f,index:s},null,8,["item","index"]))),128)),n(T,null,{default:a(()=>[K(n(_,{unelevated:"",rounded:"",color:"primary",class:"full-width",label:e.t("base.readAllNotifications"),to:"/notifications"},null,8,["label"]),[[de]])]),_:1})],64)):(l(),d(e.AppResult,{key:2,status:"empty",description:e.t("error.dataNotfound")},null,8,["description"]))]),_:1})}const be=A(he,[["render",Ne],["__file","NotificationBarMenu.vue"]]),ve=w({__name:"AppHeader",props:{bordered:{type:Boolean,default:!1},reveal:{type:Boolean,default:!1},showTogleDrawer:{type:Boolean,default:!1},frontend:{type:Boolean},showLogo:{type:Boolean,default:!0},hambergerMenu:{type:Boolean},hambergerIcon:{default:()=>Z},hambergerIconOff:{},showUserSetting:{type:Boolean,default:!0}},setup(c,{expose:o}){o();const t=J(),e=N(!1),{notify:i,resetBadgeCount:u}=M(),{t:f}=O(),s=W(),r=N(!1),g={$q:t,showGotTopBtn:e,notify:i,resetBadgeCount:u,t:f,langugeAndThemeStore:s,showSearch:r,onOpenSearch:()=>{r.value=!0},onScroll:k=>{k&&k.position&&k.position.top>100?e.value=!0:e.value=!1},get biAppIndicator(){return X},get biBell(){return $},get biCameraVideo(){return ee},get biChatDots(){return te},get biSearch(){return ae},NotificationBarMenu:be};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),ke=["src"],Se={class:"q-mr-sm text-muted"},we={class:"q-gutter-md row items-center no-wrap"};function Ae(c,o,t,e,i,u){return l(),d(le,{reveal:t.reveal,"height-hint":"58",bordered:t.bordered,elevated:e.showGotTopBtn,class:L({"wee-second-bg-color-theme-dark text-white":e.$q.dark.isActive,"bg-white text-black":!e.$q.dark.isActive})},{default:a(()=>[n(oe,{onScroll:e.onScroll}),n(re,{class:"q-py-xs"},{default:a(()=>[t.showTogleDrawer?(l(),d(_,{key:0,dense:"",flat:"",round:"",icon:t.hambergerIcon,onClick:o[0]||(o[0]=f=>e.langugeAndThemeStore.setLeftDrawer(!e.langugeAndThemeStore.leftDrawerOpen))},null,8,["icon"])):y("",!0),t.showLogo?(l(),d(_,{key:1,flat:"","no-caps":"","no-wrap":"",class:"q-mr-xs",ripple:!1,to:"/"},{default:a(()=>[n(D,{style:{height:"auto",width:"42px"},square:""},{default:a(()=>[v("img",{src:e.$q.dark.isActive?"/quasar-starter-template/logo/logo-white.png":"/quasar-starter-template/logo/logo-black.png"},null,8,ke)]),_:1})]),_:1})):y("",!0),e.$q.screen.gt.xs?(l(),d(_,{key:2,flat:"",onClick:e.onOpenSearch,class:"text-capitalize"},{default:a(()=>[v("span",Se,h(e.t("base.search")+" Vue Quasar"),1),n(P,{name:e.biSearch},null,8,["name"])]),_:1})):y("",!0),n(ne),v("div",we,[e.$q.screen.gt.sm?(l(),d(_,{key:0,round:"",dense:"",flat:"",icon:e.biCameraVideo},{default:a(()=>[n(b,null,{default:a(()=>o[1]||(o[1]=[p("Create a video or post")])),_:1})]),_:1},8,["icon"])):y("",!0),e.$q.screen.gt.sm?(l(),d(_,{key:1,round:"",dense:"",flat:"",icon:e.biAppIndicator},{default:a(()=>[n(b,null,{default:a(()=>o[2]||(o[2]=[p("Apps")])),_:1})]),_:1},8,["icon"])):y("",!0),e.$q.screen.gt.sm?(l(),d(_,{key:2,round:"",dense:"",flat:"",icon:e.biChatDots,to:"/chats"},{default:a(()=>[n(b,null,{default:a(()=>o[3]||(o[3]=[p("Messages")])),_:1})]),_:1},8,["icon"])):y("",!0),e.$q.screen.gt.xs?y("",!0):(l(),d(_,{key:3,round:"",dense:"",flat:"",onClick:e.onOpenSearch},{default:a(()=>[n(P,{name:e.biSearch},null,8,["name"])]),_:1})),n(_,{round:"",dense:"",flat:"",onClick:e.resetBadgeCount,icon:e.biBell},{default:a(()=>[e.notify&&e.notify.totalNotify?(l(),d(ie,{key:0,color:"negative",rounded:"","text-color":"white",floating:""},{default:a(()=>[p(h(e.notify.totalNotify>99?"99+":e.notify.totalNotify),1)]),_:1})):y("",!0),n(b,null,{default:a(()=>[p(h(e.t("nav.notifications")),1)]),_:1}),n(se,{anchor:"bottom left",self:"top left",style:{width:"360px"}},{default:a(()=>[n(e.NotificationBarMenu)]),_:1})]),_:1},8,["onClick","icon"])])]),_:1})]),_:1},8,["reveal","bordered","elevated","class"])}const Re=A(ve,[["render",Ae],["__file","AppHeader.vue"]]);export{Re as A};
