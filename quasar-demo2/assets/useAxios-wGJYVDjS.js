const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-CIzcZhMd.js","assets/index-Bhd6CteR.js","assets/index-HNifYG8Q.css"])))=>i.map(i=>d[i]);
import{cQ as Z,Z as Q,cR as q,T as ee,bE as B,r as P,cS as te,w as H,cT as ne,cU as ae,z as se,an as oe,cV as ie,cW as ce,cX as re,cY as ue,cZ as le,c_ as fe,ax as de,av as X,ay as ye,az as pe,c$ as he,d0 as x,cg as W,d1 as j,d2 as k,d3 as ve,cC as Y,u as me,a as ge,bM as z,d4 as Se,bN as we,d5 as b,P as Ae,d6 as V,aI as U}from"./index-Bhd6CteR.js";const N=Z("Device",{web:()=>Q(()=>import("./web-CIzcZhMd.js"),__vite__mapDeps([0,1,2])).then(e=>new e.DeviceWeb)});function be(e){return ne()?(ae(e),!0):!1}function R(e){return typeof e=="function"?e():q(e)}const Te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ce=Object.prototype.toString,De=e=>Ce.call(e)==="[object Object]",Fe=()=>{};function Ee(e,n){function o(...i){return new Promise((y,h)=>{Promise.resolve(e(()=>n.apply(this,i),{fn:n,thisArg:this,args:i})).then(y).catch(h)})}return o}const G=e=>e();function Ke(e=G){const n=P(!0);function o(){n.value=!1}function i(){n.value=!0}const y=(...h)=>{n.value&&e(...h)};return{isActive:te(n),pause:o,resume:i,eventFilter:y}}function Le(e){return se()}function Ne(e,n,o={}){const{eventFilter:i=G,...y}=o;return H(e,Ee(i,n),y)}function Oe(e,n,o={}){const{eventFilter:i,...y}=o,{eventFilter:h,pause:S,resume:u,isActive:p}=Ke(i);return{stop:Ne(e,n,{...y,eventFilter:h}),pause:S,resume:u,isActive:p}}function Pe(e,n=!0,o){Le()?ee(e,o):n?e():B(e)}const O=Te?window:void 0;function Re(e){var n;const o=R(e);return(n=o==null?void 0:o.$el)!=null?n:o}function $(...e){let n,o,i,y;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,i,y]=e,n=O):[n,o,i,y]=e,!n)return Fe;Array.isArray(o)||(o=[o]),Array.isArray(i)||(i=[i]);const h=[],S=()=>{h.forEach(m=>m()),h.length=0},u=(m,l,w,a)=>(m.addEventListener(l,w,a),()=>m.removeEventListener(l,w,a)),p=H(()=>[Re(n),R(y)],([m,l])=>{if(S(),!m)return;const w=De(l)?{...l}:l;h.push(...o.flatMap(a=>i.map(f=>u(m,a,f,w))))},{immediate:!0,flush:"post"}),v=()=>{p(),S()};return be(v),v}const K=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L="__vueuse_ssr_handlers__",_e=Me();function Me(){return L in K||(K[L]=K[L]||{}),K[L]}function Ie(e,n){return _e[e]||n}function xe(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const We={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},J="vueuse-storage";function A(e,n,o,i={}){var y;const{flush:h="pre",deep:S=!0,listenToStorageChanges:u=!0,writeDefaults:p=!0,mergeDefaults:v=!1,shallow:m,window:l=O,eventFilter:w,onError:a=t=>{console.error(t)},initOnMounted:f}=i,g=(m?oe:P)(typeof n=="function"?n():n);if(!o)try{o=Ie("getDefaultStorage",()=>{var t;return(t=O)==null?void 0:t.localStorage})()}catch(t){a(t)}if(!o)return g;const c=R(n),T=xe(c),r=(y=i.serializer)!=null?y:We[T],{pause:C,resume:D}=Oe(g,()=>_(g.value),{flush:h,deep:S,eventFilter:w});l&&u&&Pe(()=>{o instanceof Storage?$(l,"storage",E):$(l,J,I),f&&E()}),f||E();function F(t,s){if(l){const d={key:e,oldValue:t,newValue:s,storageArea:o};l.dispatchEvent(o instanceof Storage?new StorageEvent("storage",d):new CustomEvent(J,{detail:d}))}}function _(t){try{const s=o.getItem(e);if(t==null)F(s,null),o.removeItem(e);else{const d=r.write(t);s!==d&&(o.setItem(e,d),F(s,d))}}catch(s){a(s)}}function M(t){const s=t?t.newValue:o.getItem(e);if(s==null)return p&&c!=null&&o.setItem(e,r.write(c)),c;if(!t&&v){const d=r.read(s);return typeof v=="function"?v(d,c):T==="object"&&!Array.isArray(d)?{...c,...d}:d}else return typeof s!="string"?s:r.read(s)}function E(t){if(!(t&&t.storageArea!==o)){if(t&&t.key==null){g.value=c;return}if(!(t&&t.key!==e)){C();try{(t==null?void 0:t.newValue)!==r.write(g.value)&&(g.value=M(t))}catch(s){a(s)}finally{t?B(D):D()}}}}function I(t){E(t.detail)}return g}const je=()=>{const e=A(ie,[]),n=A(ce,[]),o=A(re.YEAR_AVAILABLE,[]),i=A(ue,0),y=A(le,!0),h=A(fe,null),S=A(de,null),u=A(X,null),p=A(ye,null),v=A(pe,null),m=A(he,{}),l=t=>{if(n.value&&n.value.length>0)return n.value.find(s=>s.key==t)},w=t=>n.value?n.value.findIndex(s=>s.key==t):-1,a=t=>{const s=w(t);s>=0&&n.value.splice(s,1)},f=t=>{const s=l(t);if(n.value||(n.value=[]),!s){const d=k();n.value.push({key:t,date:d.toLocaleDateString()})}},g=(t,s="DAY")=>{a(t),s=="DAY"?f(t):s=="MONTH"?r(t):s=="YEAR"&&D(t)},c=t=>{const s=l(t);if(!s)return!0;const d=k();return s.date!=d.toLocaleDateString()},T=t=>{const s=l(t);if(!s)return!0;const d=x();return s.date!=d},r=t=>{l(t)||n.value.push({key:t,date:x()})},C=t=>{const s=l(t);if(!s)return!0;const d=W();return s.date!=d},D=t=>{l(t)||n.value.push({key:t,date:W()})},F=()=>{n.value=null,o.value=null};return{findByKey:l,onAddNewKey:f,onUpdateKey:g,destroyCache:F,canFecthToServerToday:c,canFecthToServerYear:C,cacheYearAvailables:o,fcmSetting:y,fcmToken:h,refeshTokenKey:S,authTokenKey:u,authTokenExpireKey:p,authTokenCreatedKey:v,cacheNotifyCount:m,logoutClear:()=>{m.value=null,F()},SearchHistoryList:e,fetchFromCacheToday:(t,s)=>!c(t)&&s&&!j(s),fetchFromCacheList:(t,s)=>!t&&s&&s.length>0,canFecthToServerMonth:T,fetchFromCacheMonth:(t,s)=>!T(t)&&s&&!j(s),latestSyncActiveStatus:i}},ke=()=>{const e=P(),{latestSyncActiveStatus:n}=je();return{getDeviceInfo:async()=>{const u=await N.getInfo();return new Promise(p=>{p(u)})},isWeb:async()=>{const u=await N.getInfo();return new Promise(p=>{p(u.platform=="web")})},getDeviceId:async()=>{const u=await N.getId();return new Promise(p=>{e.value=u?u.identifier:void 0,p(u?u.identifier:void 0)})},deviceId:e,canSyncActiveStatusToServer:()=>new Promise(u=>{const p=Y();let v;n.value>0?v=ve(n.value,p):(n.value=p,u(!0)),v!=null&&v>=5&&(n.value=p,u(!0)),u(!1)}),setSysncActiveStatus:()=>{n.value=Y()}}},ze=()=>{const{canSyncActiveStatusToServer:e}=ke(),{appToast:n,appLoading:o,isDevMode:i}=me(),{locale:y}=ge(),h=Ae,S=a=>a?z(a)||Se(a)?new Promise(f=>{f(null)}):new Promise(f=>{f(a)}):new Promise(f=>{f(null)}),u=a=>{var f;o(!1),n(`<strong>${a.message}</strong><br> ${(f=a.errors)==null?void 0:f.join("<br>")}`,{multiLine:!0,html:!0,type:"negative",timeout:0,position:"bottom",caption:V(a.timestamp,y.value),actions:[{icon:U,color:"white"}]})},p=a=>{a.message&&(o(!1),n(a.message,{multiLine:!0,html:!0,type:a.status=="OK"||a.status=="CREATED"?"positive":"negative",timeout:a.status=="OK"||a.status=="CREATED"?3*1e3:10*1e3,position:"bottom",caption:V(a.timestamp,y.value),actions:[{icon:U,color:"white"}]}))},v=async a=>new Promise(async(f,g)=>{w(a).then(async c=>{c.status!=401&&c.status!=403&&m(c);const T=await S(c.data);f(T)}).catch(c=>{g(c)})}),m=a=>{a&&a.data&&(z(a.data)?u(a.data):we(a.data)&&p(a.data))},l=async a=>new Promise(async(f,g)=>{w(a,!1).then(c=>{f(c)}).catch(c=>{g(c)})}),w=async(a,f=!0)=>{const g=await e();return new Promise((c,T)=>{b.defaults.headers.Authorization=`Bearer ${h.get(X)}`,a.baseURL!=null?b.defaults.baseURL=a.baseURL:b.defaults.baseURL="https://api.yourdomain.com",a.contentType?b.defaults.headers["Content-Type"]=a.contentType:b.defaults.headers["Content-Type"]="application/json",a.responseType?b.defaults.responseType=a.responseType:b.defaults.responseType="json",b.defaults.headers["X-Sync-Active"]=g?"1":"0",b({method:a.method,url:a.API,data:a.body?a.body:void 0}).then(r=>{i()&&f&&console.log(`api ${b.defaults.baseURL}${a.API}`,r),c(r)}).catch(r=>{var C;o(!1),r!=null&&r.response&&r.response.status!=401&&r.response.status!=403&&(C=r==null?void 0:r.response)!=null&&C.data&&m(r==null?void 0:r.response),T(r)})})};return{callAxios:v,validateServerResponse:S,callAxiosFile:l,callAxiosProcess:w}};export{je as a,ke as b,ze as u};
