const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BSsWqb1k.js","assets/index-ffBvIxcR.js","assets/index-HNifYG8Q.css"])))=>i.map(i=>d[i]);
import{cY as Z,T as Q,bD as U,r as P,cZ as q,w as H,c_ as ee,c$ as te,z as ne,an as ae,d0 as se,d1 as oe,d2 as ie,d3 as re,d4 as ce,d5 as ue,ax as le,av as G,ay as fe,az as de,d6 as ye,d7 as x,cf as j,d8 as W,d9 as k,da as pe,Z as he,db as ve,cB as Y,u as me,a as ge,bL as z,dc as Se,bM as we,dd as b,P as Ae,de as V,aI as $}from"./index-ffBvIxcR.js";function be(e){return ee()?(te(e),!0):!1}function _(e){return typeof e=="function"?e():Z(e)}const Te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const De=Object.prototype.toString,Ce=e=>De.call(e)==="[object Object]",Fe=()=>{};function Ee(e,n){function o(...i){return new Promise((y,h)=>{Promise.resolve(e(()=>n.apply(this,i),{fn:n,thisArg:this,args:i})).then(y).catch(h)})}return o}const X=e=>e();function Ke(e=X){const n=P(!0);function o(){n.value=!1}function i(){n.value=!0}const y=(...h)=>{n.value&&e(...h)};return{isActive:q(n),pause:o,resume:i,eventFilter:y}}function Le(e){return ne()}function Ne(e,n,o={}){const{eventFilter:i=X,...y}=o;return H(e,Ee(i,n),y)}function Oe(e,n,o={}){const{eventFilter:i,...y}=o,{eventFilter:h,pause:S,resume:u,isActive:p}=Ke(i);return{stop:Ne(e,n,{...y,eventFilter:h}),pause:S,resume:u,isActive:p}}function Pe(e,n=!0,o){Le()?Q(e,o):n?e():U(e)}const O=Te?window:void 0;function _e(e){var n;const o=_(e);return(n=o==null?void 0:o.$el)!=null?n:o}function B(...e){let n,o,i,y;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,i,y]=e,n=O):[n,o,i,y]=e,!n)return Fe;Array.isArray(o)||(o=[o]),Array.isArray(i)||(i=[i]);const h=[],S=()=>{h.forEach(m=>m()),h.length=0},u=(m,l,w,a)=>(m.addEventListener(l,w,a),()=>m.removeEventListener(l,w,a)),p=H(()=>[_e(n),_(y)],([m,l])=>{if(S(),!m)return;const w=Ce(l)?{...l}:l;h.push(...o.flatMap(a=>i.map(f=>u(m,a,f,w))))},{immediate:!0,flush:"post"}),v=()=>{p(),S()};return be(v),v}const K=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L="__vueuse_ssr_handlers__",Me=Re();function Re(){return L in K||(K[L]=K[L]||{}),K[L]}function Ie(e,n){return Me[e]||n}function xe(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const je={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},J="vueuse-storage";function A(e,n,o,i={}){var y;const{flush:h="pre",deep:S=!0,listenToStorageChanges:u=!0,writeDefaults:p=!0,mergeDefaults:v=!1,shallow:m,window:l=O,eventFilter:w,onError:a=t=>{console.error(t)},initOnMounted:f}=i,g=(m?ae:P)(typeof n=="function"?n():n);if(!o)try{o=Ie("getDefaultStorage",()=>{var t;return(t=O)==null?void 0:t.localStorage})()}catch(t){a(t)}if(!o)return g;const r=_(n),T=xe(r),c=(y=i.serializer)!=null?y:je[T],{pause:D,resume:C}=Oe(g,()=>M(g.value),{flush:h,deep:S,eventFilter:w});l&&u&&Pe(()=>{o instanceof Storage?B(l,"storage",E):B(l,J,I),f&&E()}),f||E();function F(t,s){if(l){const d={key:e,oldValue:t,newValue:s,storageArea:o};l.dispatchEvent(o instanceof Storage?new StorageEvent("storage",d):new CustomEvent(J,{detail:d}))}}function M(t){try{const s=o.getItem(e);if(t==null)F(s,null),o.removeItem(e);else{const d=c.write(t);s!==d&&(o.setItem(e,d),F(s,d))}}catch(s){a(s)}}function R(t){const s=t?t.newValue:o.getItem(e);if(s==null)return p&&r!=null&&o.setItem(e,c.write(r)),r;if(!t&&v){const d=c.read(s);return typeof v=="function"?v(d,r):T==="object"&&!Array.isArray(d)?{...r,...d}:d}else return typeof s!="string"?s:c.read(s)}function E(t){if(!(t&&t.storageArea!==o)){if(t&&t.key==null){g.value=r;return}if(!(t&&t.key!==e)){D();try{(t==null?void 0:t.newValue)!==c.write(g.value)&&(g.value=R(t))}catch(s){a(s)}finally{t?U(C):C()}}}}function I(t){E(t.detail)}return g}const We=()=>{const e=A(se,[]),n=A(oe,[]),o=A(ie.YEAR_AVAILABLE,[]),i=A(re,0),y=A(ce,!0),h=A(ue,null),S=A(le,null),u=A(G,null),p=A(fe,null),v=A(de,null),m=A(ye,{}),l=t=>{if(n.value&&n.value.length>0)return n.value.find(s=>s.key==t)},w=t=>n.value?n.value.findIndex(s=>s.key==t):-1,a=t=>{const s=w(t);s>=0&&n.value.splice(s,1)},f=t=>{const s=l(t);if(n.value||(n.value=[]),!s){const d=k();n.value.push({key:t,date:d.toLocaleDateString()})}},g=(t,s="DAY")=>{a(t),s=="DAY"?f(t):s=="MONTH"?c(t):s=="YEAR"&&C(t)},r=t=>{const s=l(t);if(!s)return!0;const d=k();return s.date!=d.toLocaleDateString()},T=t=>{const s=l(t);if(!s)return!0;const d=x();return s.date!=d},c=t=>{l(t)||n.value.push({key:t,date:x()})},D=t=>{const s=l(t);if(!s)return!0;const d=j();return s.date!=d},C=t=>{l(t)||n.value.push({key:t,date:j()})},F=()=>{n.value=null,o.value=null};return{findByKey:l,onAddNewKey:f,onUpdateKey:g,destroyCache:F,canFecthToServerToday:r,canFecthToServerYear:D,cacheYearAvailables:o,fcmSetting:y,fcmToken:h,refeshTokenKey:S,authTokenKey:u,authTokenExpireKey:p,authTokenCreatedKey:v,cacheNotifyCount:m,logoutClear:()=>{m.value=null,F()},SearchHistoryList:e,fetchFromCacheToday:(t,s)=>!r(t)&&s&&!W(s),fetchFromCacheList:(t,s)=>!t&&s&&s.length>0,canFecthToServerMonth:T,fetchFromCacheMonth:(t,s)=>!T(t)&&s&&!W(s),latestSyncActiveStatus:i}},N=pe("Device",{web:()=>he(()=>import("./web-BSsWqb1k.js"),__vite__mapDeps([0,1,2])).then(e=>new e.DeviceWeb)}),ke=()=>{const e=P(),{latestSyncActiveStatus:n}=We();return{getDeviceInfo:async()=>{const u=await N.getInfo();return new Promise(p=>{p(u)})},isWeb:async()=>{const u=await N.getInfo();return new Promise(p=>{p(u.platform=="web")})},getDeviceId:async()=>{const u=await N.getId();return new Promise(p=>{e.value=u?u.identifier:void 0,p(u?u.identifier:void 0)})},deviceId:e,canSyncActiveStatusToServer:()=>new Promise(u=>{const p=Y();let v;n.value>0?v=ve(n.value,p):(n.value=p,u(!0)),v!=null&&v>=5&&(n.value=p,u(!0)),u(!1)}),setSysncActiveStatus:()=>{n.value=Y()}}},ze=()=>{const{canSyncActiveStatusToServer:e}=ke(),{appToast:n,appLoading:o,isDevMode:i}=me(),{locale:y}=ge(),h=Ae,S=a=>a?z(a)||Se(a)?new Promise(f=>{f(null)}):new Promise(f=>{f(a)}):new Promise(f=>{f(null)}),u=a=>{var f;o(!1),n(`<strong>${a.message}</strong><br> ${(f=a.errors)==null?void 0:f.join("<br>")}`,{multiLine:!0,html:!0,type:"negative",timeout:0,position:"bottom",caption:V(a.timestamp,y.value),actions:[{icon:$,color:"white"}]})},p=a=>{a.message&&(o(!1),n(a.message,{multiLine:!0,html:!0,type:a.status=="OK"||a.status=="CREATED"?"positive":"negative",timeout:a.status=="OK"||a.status=="CREATED"?3*1e3:10*1e3,position:"bottom",caption:V(a.timestamp,y.value),actions:[{icon:$,color:"white"}]}))},v=async a=>new Promise(async(f,g)=>{w(a).then(async r=>{r.status!=401&&r.status!=403&&m(r);const T=await S(r.data);f(T)}).catch(r=>{g(r)})}),m=a=>{a&&a.data&&(z(a.data)?u(a.data):we(a.data)&&p(a.data))},l=async a=>new Promise(async(f,g)=>{w(a,!1).then(r=>{f(r)}).catch(r=>{g(r)})}),w=async(a,f=!0)=>{const g=await e();return new Promise((r,T)=>{b.defaults.headers.Authorization=`Bearer ${h.get(G)}`,a.baseURL!=null?b.defaults.baseURL=a.baseURL:b.defaults.baseURL="https://api.yourdomain.com",a.contentType?b.defaults.headers["Content-Type"]=a.contentType:b.defaults.headers["Content-Type"]="application/json",a.responseType?b.defaults.responseType=a.responseType:b.defaults.responseType="json",b.defaults.headers["X-Sync-Active"]=g?"1":"0",b({method:a.method,url:a.API,data:a.body?a.body:void 0}).then(c=>{i()&&f&&console.log(`api ${b.defaults.baseURL}${a.API}`,c),r(c)}).catch(c=>{var D;o(!1),c!=null&&c.response&&c.response.status!=401&&c.response.status!=403&&(D=c==null?void 0:c.response)!=null&&D.data&&m(c==null?void 0:c.response),T(c)})})};return{callAxios:v,validateServerResponse:S,callAxiosFile:l,callAxiosProcess:w}};export{We as a,ke as b,ze as u};
