const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingPersonal-BIHkvmoe.js","assets/index-DDZXG7TO.js","assets/index-HNifYG8Q.css","assets/UserService-DXfv7_8Z.js","assets/useAxios-Oymy46L5.js","assets/useValidation-Bc5LyAvJ.js"])))=>i.map(i=>d[i]);
import{d as X,_ as R,B as x,C as T,E as o,F as a,S as F,I as r,al as Q,ad as Y,ae as W,ak as le,M as h,ab as ie,ac as ne,aE as D,O as y,R as g,aH as L,a as U,u as q,r as c,w as M,N as H,a9 as re,af as u,ag as V,bW as se,H as G,ai as J,ah as j,aC as ce,bs as de,bX as ue,bY as ge,bZ as me,b_ as fe,b$ as ve,c0 as pe,c1 as be,c2 as _e,c3 as Ce,aU as he,c4 as ye,c5 as we,f as ke,a5 as Se,Y as xe,Z as ze,aa as Ie}from"./index-DDZXG7TO.js";import{F as Ae}from"./FileManagerService-CpAt8e2p.js";import{U as Fe}from"./UserService-DXfv7_8Z.js";import{u as Oe}from"./useAppMeta-BT_adV4U.js";import{C as N,I as Pe}from"./ImageCropper-BEIiZ3sH.js";import{Q as Qe}from"./QBar-C1ux2P-L.js";import"./useAxios-Oymy46L5.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./use-meta-DbSRbusI.js";const Te=X({__name:"ProfileCard",props:{coverImage:{type:String,default:void 0},avatarImage:{type:String,default:void 0},showMedal:{type:Boolean,default:!1},height:{type:String,default:"250px"},avatarTop:{type:String,default:"75px"},avatarSize:{type:String,default:"120px"},descriptionStyle:{type:String,default:""},name:{type:String,default:""},description:{type:String,default:""}},setup(p,{expose:t}){t();const l={};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),Ve={class:"text-white absolute-center"};function Be(p,t,l,e,m,f){return x(),T(F,{flat:"",class:"bg-transparent"},{default:o(()=>[a(F,{flat:""},{default:o(()=>[r("div",{style:Q(`height: ${l.height};
            background: url(${l.coverImage?l.coverImage:"/cover.jpg"}), linear-gradient(to right, #000, #000);
            background-position: center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;`)},null,4),r("div",Ve,[a(Y,{size:l.avatarSize,style:Q({top:l.avatarTop}),class:"shadow-5"},{default:o(()=>[a(W,{"spinner-color":"white",src:l.avatarImage},null,8,["src"])]),_:1},8,["size","style"])])]),_:1}),le(p.$slots,"description",{},()=>[a(h,{class:"text-center",style:Q(l.descriptionStyle)},{default:o(()=>[a(ie,{dense:""},{default:o(()=>[a(ne,null,{default:o(()=>[a(D,{class:"text-weight-bold",lines:"1"},{default:o(()=>[y(g(l.name),1)]),_:1}),a(D,{caption:""},{default:o(()=>[y(g(l.description),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])])]),_:3})}const Le=R(Te,[["render",Be],["__file","ProfileCard.vue"]]),Ue={__name:"ImageCropperCover",props:{dialog:{type:Boolean,default:!1},title:{type:String,default:void 0}},emits:["on-close","on-okay"],setup(p,{expose:t,emit:l}){t();const e=p,m=L(),f=l,{t:i}=U(),{appToast:b}=q(),d=c(null),n=c(null),_=c(null),w=c(1),k=c(1),O=c(!1),P=c(!1),z=c(!1),I=c(null),S=()=>{s(),_.value=null,f("on-close"),P.value=!1},s=()=>{n.value&&(n.value.clear(),n.value.destroy())},C=()=>{s();const v={aspectRatio:16/9,preview:".cropper-img-preview",ready:function(){B()},cropstart:function(){},cropmove:function(){},cropend:function(){B()},crop:function(){},zoom:function(){}};n.value=new N(d.value,v)},K=v=>{v&&(/^image\/\w+/.test(_.value.type)?(d.value.src=URL.createObjectURL(_.value),C()):b("Please choose an image file.",{type:"negative"}))},$=()=>{n.value&&(k.value=k.value*-1,n.value.scaleX(k.value))},ee=()=>{n.value&&(w.value=w.value*-1,n.value.scaleY(w.value))},E=(v,A)=>new Promise(oe=>{const te=new File([v],A.name,{lastModified:A.lastModified,type:A.type});oe(te)}),ae=()=>{n.value&&n.value.cropped&&(z.value=!0,n.value.getCroppedCanvas().toBlob(async v=>{const A=await E(v,_.value);z.value=!1,f("on-okay",A),S()},"image/jpeg"))},B=()=>{n.value&&(I.value=n.value.getCroppedCanvas().toDataURL("image/jpeg"))};M(()=>e.dialog,v=>{O.value=v});const Z={props:e,authenStore:m,emit:f,t:i,appToast:b,canvasImg:d,cropper:n,originalimagFile:_,horizontalScale:w,verticalScale:k,show:O,maximizedToggle:P,loading:z,priviewImage:I,onClose:S,clearCropper:s,onInitCroper:C,onFileAdded:K,flipHorizontal:$,flipVertical:ee,blobToFile:E,onOkay:ae,cropData:B,ref:c,watch:M,get Cropper(){return N},get useLang(){return U},get useBase(){return q},ProfileCard:Le,get useAuthenStore(){return L},get biFullscreen(){return ue},get biXSquare(){return ge},get biCrop(){return me},get biZoomIn(){return fe},get biZoomOut(){return ve},get biArrowClockwise(){return pe},get biArrowCounterclockwise(){return be},get biArrowsCollapse(){return _e},get biArrowLeftRight(){return Ce},get biCheck(){return he},get biFileImage(){return ye},get biFullscreenExit(){return we}};return Object.defineProperty(Z,"__isScriptSetup",{enumerable:!1,value:!0}),Z}},qe={class:"row"},je={class:"col-12 col-md-5"},Re={class:"q-pa-md"},Ee={class:"col-12 col-md-7"},Ze={ref:"canvasImg",style:{display:"block","max-width":"100%",height:"550px"},alt:""};function De(p,t,l,e,m,f){return x(),T(de,{modelValue:e.show,"onUpdate:modelValue":t[6]||(t[6]=i=>e.show=i),persistent:"",maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:o(()=>[a(F,{style:{"min-width":"80%"},flat:"",bordered:""},{default:o(()=>[a(Qe,null,{default:o(()=>[a(H,{name:e.biCrop},null,8,["name"]),r("div",null,g(l.title||""),1),a(re),a(u,{dense:"",flat:"",icon:e.maximizedToggle?e.biFullscreenExit:e.biFullscreen,onClick:t[0]||(t[0]=i=>e.maximizedToggle=!e.maximizedToggle)},{default:o(()=>[a(V,null,{default:o(()=>[y(g(e.maximizedToggle?e.t("minimize"):e.t("maximize")),1)]),_:1})]),_:1},8,["icon"]),a(u,{dense:"",flat:"",icon:e.biXSquare,onClick:e.onClose},{default:o(()=>[a(V,null,{default:o(()=>[y(g(e.t("base.close")),1)]),_:1})]),_:1},8,["icon"])]),_:1}),r("div",qe,[r("div",je,[a(h,null,{default:o(()=>[a(se,{filled:"","bottom-slots":"",modelValue:e.originalimagFile,"onUpdate:modelValue":[t[1]||(t[1]=i=>e.originalimagFile=i),e.onFileAdded],label:e.t("base.chooseFile"),counter:"","max-files":"1",accept:".jpg, .png, image/*"},{prepend:o(()=>[a(H,{name:e.biFileImage},null,8,["name"])]),hint:o(()=>[y(g(e.t("error.filesValidationSizeAndType",{size:10,extension:".jpg, .png"})),1)]),_:1},8,["modelValue","label"])]),_:1}),e.originalimagFile?(x(),G(J,{key:0},[a(h,{class:"q-gutter-sm text-center"},{default:o(()=>{var i,b;return[a(e.ProfileCard,{"avatar-image":(b=(i=e.authenStore.auth)==null?void 0:i.avatar)==null?void 0:b.image,"cover-image":e.priviewImage,name:e.authenStore.loginedDisplay,description:e.t("app.name"),height:"250px","avatar-top":"105px",descriptionStyle:"margin-top:35px"},null,8,["avatar-image","cover-image","name","description"])]}),_:1}),r("div",Re,[a(u,{icon:e.biCheck,label:e.t("base.okay"),class:"full-width",color:"positive",unelevated:"",loading:e.loading,onClick:e.onOkay},null,8,["icon","label","loading"])])],64)):j("",!0)]),r("div",Ee,[a(h,null,{default:o(()=>[r("div",{class:ce(p.$q.dark.isActive?"bg-grey-10":"bg-grey-1")},[r("img",Ze,null,512)],2)]),_:1}),e.originalimagFile?(x(),T(h,{key:0,class:"q-gutter-sm"},{default:o(()=>[a(u,{icon:e.biZoomIn,dense:"",label:e.t("zoomIn"),flat:"",onClick:t[2]||(t[2]=i=>e.cropper.zoom(.1))},null,8,["icon","label"]),a(u,{icon:e.biZoomOut,dense:"",label:e.t("zoomOut"),flat:"",onClick:t[3]||(t[3]=i=>e.cropper.zoom(-.1))},null,8,["icon","label"]),a(u,{label:e.t("rotateLeft"),dense:"",icon:e.biArrowCounterclockwise,flat:"",onClick:t[4]||(t[4]=i=>e.cropper.rotate(-45))},null,8,["label","icon"]),a(u,{label:e.t("rotateRight"),dense:"",icon:e.biArrowClockwise,flat:"",onClick:t[5]||(t[5]=i=>e.cropper.rotate(45))},null,8,["label","icon"]),a(u,{label:e.t("flipHorizontal"),dense:"",icon:e.biArrowLeftRight,flat:"",onClick:e.flipHorizontal},null,8,["label","icon"]),a(u,{label:e.t("flipVorizontal"),dense:"",icon:e.biArrowsCollapse,flat:"",onClick:e.flipVertical},null,8,["label","icon"])]),_:1})):j("",!0)])])]),_:1})]),_:1},8,["modelValue","maximized"])}const Me=R(Ue,[["render",De],["__file","ImageCropperCover.vue"]]),He=X({__name:"profile",setup(p,{expose:t}){t();const l=xe(()=>ze(()=>import("./SettingPersonal-BIHkvmoe.js"),__vite__mapDeps([0,1,2,3,4,5])));Oe();const{t:e}=U(),{appLoading:m}=q(),{uploadApi:f}=Ae(),{updateUserAvatar:i,updateUserCover:b}=Fe(),d=L(),n=c(!1),_=c(!1),w=async S=>{m();const s=await f(S);if(s&&d.auth&&s.id){await i(s.id);const C=d.auth;C.avatar&&(C.avatar.thumbnail=s.fileThumbnailPath,C.avatar.image=s.filePath)}m(!1)},k=()=>{n.value=!0},O=()=>{_.value=!0},P=async S=>{m();const s=await f(S);if(s&&d.auth&&s.id){await b(s.id);const C=d.auth;C.cover={thumbnail:s.fileThumbnailPath,image:s.filePath}}m(!1)},z=ke(()=>`height: 175px;
            background: url(${d.loginedCover?d.loginedCover:"/cover.jpg"}), linear-gradient(to right, #000, #000);
            background-position: center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;`),I={SettingPersonal:l,t:e,appLoading:m,uploadApi:f,updateUserAvatar:i,updateUserCover:b,authenStore:d,dialog:n,dialogCover:_,onOkay:w,onOpenCropper:k,onOpenCropperCover:O,onUploadCover:P,coverStle:z,get biPencilFill(){return Se},ImageCropper:Pe,ImageCropperCover:Me};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),Ne={class:"q-pl-lg"},Xe={class:"text-h6"},Ye={class:"text-white absolute-right q-pa-md"},We={class:"text-white absolute-center"},Ge={class:"absolute-bottom",style:{top:"55px"}},Je={class:"text-h6 text-weight-bold q-mt-md"},Ke={class:"text-muted"};function $e(p,t,l,e,m,f){return x(),G(J,null,[r("div",Ne,[a(F,{square:"",flat:"",class:"bg-transparent"},{default:o(()=>[a(h,null,{default:o(()=>[r("div",Xe,g(e.t("base.editPhoto")),1),a(Ie)]),_:1}),a(h,null,{default:o(()=>[e.authenStore.auth?(x(),T(F,{key:0,class:"shadow-up-5"},{default:o(()=>[r("div",{style:Q(e.coverStle)},null,4),r("div",Ye,[a(u,{onClick:e.onOpenCropperCover,round:"",unelevated:"",color:"pink",icon:e.biPencilFill},{default:o(()=>[a(V,null,{default:o(()=>[y(g(e.t("base.changeCover")),1)]),_:1})]),_:1},8,["icon"])]),r("div",We,[a(Y,{size:"120px",style:{top:"75px"},class:"shadow-5"},{default:o(()=>[a(W,{"spinner-color":"white",src:e.authenStore.loginedAvatar},null,8,["src"]),r("div",Ge,[a(u,{onClick:e.onOpenCropper,round:"",icon:e.biPencilFill,color:"pink"},{default:o(()=>[a(V,null,{default:o(()=>[y(g(e.t("base.changeAvatar")),1)]),_:1})]),_:1},8,["icon"])])]),_:1})])]),_:1})):j("",!0)]),_:1}),a(h,{class:"text-center"},{default:o(()=>[r("div",Je,g(e.authenStore.loginedDisplay),1),r("div",Ke,g(e.t("app.name")),1)]),_:1})]),_:1}),a(e.SettingPersonal)]),a(e.ImageCropper,{title:e.t("cropAvatar"),dialog:e.dialog,onOnClose:t[0]||(t[0]=i=>e.dialog=!1),onOnOkay:e.onOkay},null,8,["title","dialog"]),a(e.ImageCropperCover,{title:e.t("base.changeCover"),dialog:e.dialogCover,onOnClose:t[1]||(t[1]=i=>e.dialogCover=!1),onOnOkay:e.onUploadCover},null,8,["title","dialog"])],64)}const ca=R(He,[["render",$e],["__file","profile.vue"]]);export{ca as default};
